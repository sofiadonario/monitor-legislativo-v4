var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,n=(s,t,a)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,i=(e,s)=>{for(var t in s||(s={}))r.call(s,t)&&n(e,t,s[t]);if(a)for(var t of a(s))l.call(s,t)&&n(e,t,s[t]);return e},c=(e,a)=>s(e,t(a));import{j as o}from"./index-DshiUUTS.js";import{r as d,R as h}from"./leaflet-vendor-CuwtxqHJ.js";import{p as u,n as m,a as p}from"./Dashboard-D8dtKLwJ.js";import"./react-vendor-DFJYf2oa.js";import"./SkeletonLoader-DpXMiago.js";const x=new Map([["bold",d.createElement(d.Fragment,null,d.createElement("path",{d:"M168.49,199.51a12,12,0,0,1-17,17l-80-80a12,12,0,0,1,0-17l80-80a12,12,0,0,1,17,17L97,128Z"}))],["duotone",d.createElement(d.Fragment,null,d.createElement("path",{d:"M160,48V208L80,128Z",opacity:"0.2"}),d.createElement("path",{d:"M163.06,40.61a8,8,0,0,0-8.72,1.73l-80,80a8,8,0,0,0,0,11.32l80,80A8,8,0,0,0,168,208V48A8,8,0,0,0,163.06,40.61ZM152,188.69,91.31,128,152,67.31Z"}))],["fill",d.createElement(d.Fragment,null,d.createElement("path",{d:"M168,48V208a8,8,0,0,1-13.66,5.66l-80-80a8,8,0,0,1,0-11.32l80-80A8,8,0,0,1,168,48Z"}))],["light",d.createElement(d.Fragment,null,d.createElement("path",{d:"M164.24,203.76a6,6,0,1,1-8.48,8.48l-80-80a6,6,0,0,1,0-8.48l80-80a6,6,0,0,1,8.48,8.48L88.49,128Z"}))],["regular",d.createElement(d.Fragment,null,d.createElement("path",{d:"M165.66,202.34a8,8,0,0,1-11.32,11.32l-80-80a8,8,0,0,1,0-11.32l80-80a8,8,0,0,1,11.32,11.32L91.31,128Z"}))],["thin",d.createElement(d.Fragment,null,d.createElement("path",{d:"M162.83,205.17a4,4,0,0,1-5.66,5.66l-80-80a4,4,0,0,1,0-5.66l80-80a4,4,0,1,1,5.66,5.66L85.66,128Z"}))]]),g=new Map([["bold",d.createElement(d.Fragment,null,d.createElement("path",{d:"M184.49,136.49l-80,80a12,12,0,0,1-17-17L159,128,87.51,56.49a12,12,0,1,1,17-17l80,80A12,12,0,0,1,184.49,136.49Z"}))],["duotone",d.createElement(d.Fragment,null,d.createElement("path",{d:"M176,128,96,208V48Z",opacity:"0.2"}),d.createElement("path",{d:"M181.66,122.34l-80-80A8,8,0,0,0,88,48V208a8,8,0,0,0,13.66,5.66l80-80A8,8,0,0,0,181.66,122.34ZM104,188.69V67.31L164.69,128Z"}))],["fill",d.createElement(d.Fragment,null,d.createElement("path",{d:"M181.66,133.66l-80,80A8,8,0,0,1,88,208V48a8,8,0,0,1,13.66-5.66l80,80A8,8,0,0,1,181.66,133.66Z"}))],["light",d.createElement(d.Fragment,null,d.createElement("path",{d:"M180.24,132.24l-80,80a6,6,0,0,1-8.48-8.48L167.51,128,91.76,52.24a6,6,0,0,1,8.48-8.48l80,80A6,6,0,0,1,180.24,132.24Z"}))],["regular",d.createElement(d.Fragment,null,d.createElement("path",{d:"M181.66,133.66l-80,80a8,8,0,0,1-11.32-11.32L164.69,128,90.34,53.66a8,8,0,0,1,11.32-11.32l80,80A8,8,0,0,1,181.66,133.66Z"}))],["thin",d.createElement(d.Fragment,null,d.createElement("path",{d:"M178.83,130.83l-80,80a4,4,0,0,1-5.66-5.66L170.34,128,93.17,50.83a4,4,0,0,1,5.66-5.66l80,80A4,4,0,0,1,178.83,130.83Z"}))]]),j=new Map([["bold",d.createElement(d.Fragment,null,d.createElement("path",{d:"M232.49,215.51,185,168a92.12,92.12,0,1,0-17,17l47.53,47.54a12,12,0,0,0,17-17ZM44,112a68,68,0,1,1,68,68A68.07,68.07,0,0,1,44,112Z"}))],["duotone",d.createElement(d.Fragment,null,d.createElement("path",{d:"M192,112a80,80,0,1,1-80-80A80,80,0,0,1,192,112Z",opacity:"0.2"}),d.createElement("path",{d:"M229.66,218.34,179.6,168.28a88.21,88.21,0,1,0-11.32,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"}))],["fill",d.createElement(d.Fragment,null,d.createElement("path",{d:"M168,112a56,56,0,1,1-56-56A56,56,0,0,1,168,112Zm61.66,117.66a8,8,0,0,1-11.32,0l-50.06-50.07a88,88,0,1,1,11.32-11.31l50.06,50.06A8,8,0,0,1,229.66,229.66ZM112,184a72,72,0,1,0-72-72A72.08,72.08,0,0,0,112,184Z"}))],["light",d.createElement(d.Fragment,null,d.createElement("path",{d:"M228.24,219.76l-51.38-51.38a86.15,86.15,0,1,0-8.48,8.48l51.38,51.38a6,6,0,0,0,8.48-8.48ZM38,112a74,74,0,1,1,74,74A74.09,74.09,0,0,1,38,112Z"}))],["regular",d.createElement(d.Fragment,null,d.createElement("path",{d:"M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"}))],["thin",d.createElement(d.Fragment,null,d.createElement("path",{d:"M226.83,221.17l-52.7-52.7a84.1,84.1,0,1,0-5.66,5.66l52.7,52.7a4,4,0,0,0,5.66-5.66ZM36,112a76,76,0,1,1,76,76A76.08,76.08,0,0,1,36,112Z"}))]]),v=d.forwardRef((e,s)=>d.createElement(u,c(i({ref:s},e),{weights:x})));v.displayName="CaretLeftIcon";const y=v,b=d.forwardRef((e,s)=>d.createElement(u,c(i({ref:s},e),{weights:g})));b.displayName="CaretRightIcon";const f=b,N=d.forwardRef((e,s)=>d.createElement(u,c(i({ref:s},e),{weights:j})));N.displayName="MagnifyingGlassIcon";const w=N,C=({documents:e})=>{const s=d.useMemo(()=>{const s=new Date,t=new Date(s.getFullYear(),s.getMonth()-6,1),a=new Date(s.getFullYear()-1,s.getMonth(),1),r=new Map,l=new Map,n=new Map,i=new Map;e.forEach(e=>{r.set(e.type,(r.get(e.type)||0)+1),e.state&&l.set(e.state,(l.get(e.state)||0)+1);const s="string"==typeof e.date?new Date(e.date):e.date,t=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`;n.set(t,(n.get(t)||0)+1),e.keywords.forEach(e=>{i.set(e,(i.get(e)||0)+1)})});const c=e.length,o=Array.from(r.entries()).map(([e,s])=>({label:e,value:s,percentage:s/c*100})).sort((e,s)=>s.value-e.value),d=Array.from(l.entries()).map(([e,s])=>({label:e,value:s,percentage:s/c*100})).sort((e,s)=>s.value-e.value).slice(0,10),h=Array.from(i.entries()).map(([e,s])=>({label:e,value:s,percentage:s/c*100})).sort((e,s)=>s.value-e.value).slice(0,15),u=[];for(let e=11;e>=0;e--){const t=new Date(s.getFullYear(),s.getMonth()-e,1),a=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`,r=n.get(a)||0;u.push({label:t.toLocaleDateString("pt-BR",{month:"short",year:"2-digit"}),value:r,percentage:0})}const m=e.filter(e=>("string"==typeof e.date?new Date(e.date):e.date)>=t).length,p=e.filter(e=>("string"==typeof e.date?new Date(e.date):e.date)>=a).length;return{total:c,recentDocs:m,yearlyDocs:p,typeData:o,stateData:d,keywordData:h,monthlyData:u,averagePerMonth:Math.round(p/12)}},[e]),t=({data:e,maxValue:s})=>{const t=s||Math.max(...e.map(e=>e.value));return o.jsx("div",{className:"bar-chart",children:e.map((e,s)=>o.jsxs("div",{className:"bar-item",children:[o.jsx("div",{className:"bar-label",children:e.label}),o.jsx("div",{className:"bar-container",children:o.jsx("div",{className:"bar-fill",style:{width:e.value/t*100+"%"},children:o.jsx("span",{className:"bar-value",children:e.value})})}),e.percentage>0&&o.jsxs("div",{className:"bar-percentage",children:[e.percentage.toFixed(1),"%"]})]},s))})},a=({data:e})=>{const s=Math.max(...e.map(e=>e.value)),t=200,a=100;return o.jsx("div",{className:"line-chart",children:o.jsxs("svg",{viewBox:`0 0 ${a*e.length} 240`,preserveAspectRatio:"none",children:[[0,25,50,75,100].map(s=>o.jsx("line",{x1:"0",y1:t-t*s/100,x2:a*e.length,y2:t-t*s/100,stroke:"#e0e0e0",strokeWidth:"1"},s)),o.jsx("polyline",{points:e.map((e,r)=>`${r*a+50},${t-e.value/s*t}`).join(" "),fill:"none",stroke:"#1976d2",strokeWidth:"2"}),e.map((e,r)=>o.jsxs("g",{children:[o.jsx("circle",{cx:r*a+50,cy:t-e.value/s*t,r:"4",fill:"#1976d2"}),o.jsx("text",{x:r*a+50,y:220,textAnchor:"middle",fontSize:"12",fill:"#666",children:e.label}),o.jsx("text",{x:r*a+50,y:t-e.value/s*t-10,textAnchor:"middle",fontSize:"11",fill:"#333",fontWeight:"bold",children:e.value})]},r))]})})},r=({data:e})=>{const s=Math.max(...e.map(e=>e.value));return o.jsx("div",{className:"keyword-cloud",children:e.map((e,t)=>{const a=.8+e.value/s*1.2,r=.6+e.value/s*.4;return o.jsx("span",{className:"keyword-tag",style:{fontSize:`${a}rem`,opacity:r,color:`hsl(${200+10*t}, 70%, 45%)`},title:`${e.value} documents`,children:e.label},t)})})};return o.jsxs("div",{className:"data-visualization",children:[o.jsx("h2",{children:"Legislative Analytics Dashboard"}),o.jsxs("div",{className:"stats-grid",children:[o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-icon",children:"ğŸ“Š"}),o.jsxs("div",{className:"stat-content",children:[o.jsx("div",{className:"stat-value",children:s.total}),o.jsx("div",{className:"stat-label",children:"Total Documents"})]})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-icon",children:"ğŸ“…"}),o.jsxs("div",{className:"stat-content",children:[o.jsx("div",{className:"stat-value",children:s.recentDocs}),o.jsx("div",{className:"stat-label",children:"Last 6 Months"})]})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-icon",children:"ğŸ“ˆ"}),o.jsxs("div",{className:"stat-content",children:[o.jsx("div",{className:"stat-value",children:s.averagePerMonth}),o.jsx("div",{className:"stat-label",children:"Avg. per Month"})]})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-icon",children:"ğŸ—“ï¸"}),o.jsxs("div",{className:"stat-content",children:[o.jsx("div",{className:"stat-value",children:s.yearlyDocs}),o.jsx("div",{className:"stat-label",children:"This Year"})]})]})]}),o.jsxs("div",{className:"charts-grid",children:[o.jsxs("div",{className:"chart-container",children:[o.jsx("h3",{children:"Document Types Distribution"}),o.jsx(t,{data:s.typeData})]}),o.jsxs("div",{className:"chart-container",children:[o.jsx("h3",{children:"Top States by Legislation"}),o.jsx(t,{data:s.stateData})]}),o.jsxs("div",{className:"chart-container full-width",children:[o.jsx("h3",{children:"Monthly Trend (Last 12 Months)"}),o.jsx(a,{data:s.monthlyData})]}),o.jsxs("div",{className:"chart-container full-width",children:[o.jsx("h3",{children:"Popular Keywords"}),o.jsx(r,{data:s.keywordData})]})]}),o.jsx("div",{className:"visualization-actions",children:o.jsx("button",{className:"export-chart-btn",onClick:()=>{const e=[["Metric","Value"],["Total Documents",s.total],["Recent Documents (6 months)",s.recentDocs],["Yearly Documents",s.yearlyDocs],["Average per Month",s.averagePerMonth],"",["Document Type","Count","Percentage"],...s.typeData.map(e=>[e.label,e.value,e.percentage.toFixed(1)+"%"]),"",["State","Count","Percentage"],...s.stateData.map(e=>[e.label,e.value,e.percentage.toFixed(1)+"%"])].map(e=>e.join(",")).join("\n"),t=new Blob([e],{type:"text/csv"}),a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download=`legislative-analytics-${(new Date).toISOString().split("T")[0]}.csv`,r.click(),URL.revokeObjectURL(a)},children:"ğŸ“¥ Export Analytics (CSV)"})})]})};var k=Object.defineProperty,S=Object.defineProperties,T=Object.getOwnPropertyDescriptors,A=Object.getOwnPropertySymbols,E=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable,M=(e,s,t)=>s in e?k(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,q=(e,s)=>{for(var t in s||(s={}))E.call(s,t)&&M(e,t,s[t]);if(A)for(var t of A(s))D.call(s,t)&&M(e,t,s[t]);return e},F=(e,s)=>S(e,T(s)),L=(e,s,t)=>M(e,"symbol"!=typeof s?s+"":s,t);const O="monitor_legislativo_saved_queries",P=class e{constructor(){L(this,"queries",[]),this.loadQueries()}static getInstance(){return e.instance||(e.instance=new e),e.instance}loadQueries(){try{const e=localStorage.getItem(O);e&&(this.queries=JSON.parse(e))}catch(e){console.error("Error loading saved queries:",e),this.queries=[]}}saveQueries(){try{localStorage.setItem(O,JSON.stringify(this.queries))}catch(e){console.error("Error saving queries:",e)}}generateId(){return`query_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}getAllQueries(){return[...this.queries].sort((e,s)=>new Date(s.updatedAt).getTime()-new Date(e.updatedAt).getTime())}getPublicQueries(){return this.queries.filter(e=>e.isPublic)}getRecentQueries(e=5){return this.getAllQueries().slice(0,e)}getPopularQueries(e=5){return[...this.queries].sort((e,s)=>s.timesUsed-e.timesUsed).slice(0,e)}getQueryById(e){return this.queries.find(s=>s.id===e)}saveQuery(e,s,t={}){var a;const r=(new Date).toISOString(),l={id:this.generateId(),name:e.trim(),description:null==(a=t.description)?void 0:a.trim(),filters:q({},s),createdAt:r,updatedAt:r,timesUsed:0,isPublic:t.isPublic||!1,tags:t.tags||[]};return this.queries.push(l),this.saveQueries(),l}updateQuery(e,s){const t=this.queries.findIndex(s=>s.id===e);if(-1===t)return null;const a=this.queries[t];return this.queries[t]=F(q(q({},a),s),{updatedAt:(new Date).toISOString()}),this.saveQueries(),this.queries[t]}deleteQuery(e){const s=this.queries.findIndex(s=>s.id===e);return-1!==s&&(this.queries.splice(s,1),this.saveQueries(),!0)}useQuery(e){const s=this.getQueryById(e);return s?(s.timesUsed++,s.updatedAt=(new Date).toISOString(),this.saveQueries(),s):null}duplicateQuery(e,s){const t=this.getQueryById(e);return t?this.saveQuery(s,t.filters,{description:t.description,isPublic:!1,tags:[...t.tags]}):null}searchQueries(e){const s=e.toLowerCase();return this.queries.filter(e=>{var t;return e.name.toLowerCase().includes(s)||(null==(t=e.description)?void 0:t.toLowerCase().includes(s))||e.tags.some(e=>e.toLowerCase().includes(s))||e.filters.searchTerm.toLowerCase().includes(s)})}getQueriesByTag(e){return this.queries.filter(s=>s.tags.some(s=>s.toLowerCase()===e.toLowerCase()))}getAllTags(){const e=new Set;return this.queries.forEach(s=>{s.tags.forEach(s=>e.add(s))}),Array.from(e).sort()}exportQueries(){return JSON.stringify(this.queries,null,2)}importQueries(e){try{const s=JSON.parse(e);if(!Array.isArray(s))return{success:!1,imported:0,errors:["Invalid format: expected array"]};const t=[];let a=0;return s.forEach((e,s)=>{try{if(!this.isValidQuery(e))return void t.push(`Query ${s+1}: Invalid format`);if(this.queries.find(s=>s.name===e.name))return void t.push(`Query "${e.name}": Name already exists`);const r=F(q({},e),{id:this.generateId(),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),timesUsed:0});this.queries.push(r),a++}catch(r){t.push(`Query ${s+1}: ${r instanceof Error?r.message:"Unknown error"}`)}}),a>0&&this.saveQueries(),{success:a>0,imported:a,errors:t}}catch(s){return{success:!1,imported:0,errors:[`Parse error: ${s instanceof Error?s.message:"Unknown error"}`]}}}isValidQuery(e){return"object"==typeof e&&null!==e&&"string"==typeof e.name&&e.name.trim().length>0&&"object"==typeof e.filters&&null!==e.filters&&"string"==typeof e.filters.searchTerm&&Array.isArray(e.filters.documentTypes)&&Array.isArray(e.filters.states)&&Array.isArray(e.filters.keywords)&&"boolean"==typeof e.isPublic&&Array.isArray(e.tags)}clearAllQueries(){this.queries=[],this.saveQueries()}getStats(){const e=this.queries.length,s=this.queries.filter(e=>e.isPublic).length,t=this.queries.reduce((e,s)=>e+s.timesUsed,0);return{total:e,public:s,private:e-s,mostUsed:this.queries.length>0?this.queries.reduce((e,s)=>s.timesUsed>e.timesUsed?s:e):null,totalUsage:t}}};L(P,"instance");const Q=P.getInstance(),I=({isOpen:e,onClose:s,onSave:t,filters:a})=>{const[r,l]=d.useState(""),[n,i]=d.useState(""),[c,h]=d.useState(!1),[u,m]=d.useState(""),[p,x]=d.useState("");return e?o.jsx("div",{className:"modal-overlay",children:o.jsxs("div",{className:"modal-content",children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h3",{children:"Salvar Consulta"}),o.jsx("button",{className:"modal-close",onClick:s,children:"Ã—"})]}),o.jsxs("div",{className:"modal-body",children:[p&&o.jsx("div",{className:"error-message",children:p}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"query-name",children:"Nome da Consulta *"}),o.jsx("input",{id:"query-name",type:"text",value:r,onChange:e=>l(e.target.value),placeholder:"Ex: Documentos sobre transporte pÃºblico",maxLength:100})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"query-description",children:"DescriÃ§Ã£o"}),o.jsx("textarea",{id:"query-description",value:n,onChange:e=>i(e.target.value),placeholder:"DescriÃ§Ã£o opcional da consulta",rows:3,maxLength:500})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"query-tags",children:"Tags (separadas por vÃ­rgula)"}),o.jsx("input",{id:"query-tags",type:"text",value:u,onChange:e=>m(e.target.value),placeholder:"Ex: transporte, infraestrutura, mobilidade"})]}),o.jsx("div",{className:"form-group",children:o.jsxs("label",{className:"checkbox-label",children:[o.jsx("input",{type:"checkbox",checked:c,onChange:e=>h(e.target.checked)}),"Tornar consulta pÃºblica"]})}),o.jsxs("div",{className:"query-preview",children:[o.jsx("h4",{children:"Preview da Consulta:"}),o.jsxs("div",{className:"preview-content",children:[a.searchTerm&&o.jsxs("span",{className:"preview-tag",children:['Busca: "',a.searchTerm,'"']}),a.documentTypes.length>0&&o.jsxs("span",{className:"preview-tag",children:["Tipos: ",a.documentTypes.join(", ")]}),a.states.length>0&&o.jsxs("span",{className:"preview-tag",children:["Estados: ",a.states.join(", ")]}),a.keywords.length>0&&o.jsxs("span",{className:"preview-tag",children:["Palavras-chave: ",a.keywords.join(", ")]}),a.dateFrom&&o.jsxs("span",{className:"preview-tag",children:["De: ",a.dateFrom.toLocaleDateString()]}),a.dateTo&&o.jsxs("span",{className:"preview-tag",children:["AtÃ©: ",a.dateTo.toLocaleDateString()]})]})]})]}),o.jsxs("div",{className:"modal-footer",children:[o.jsx("button",{className:"btn-secondary",onClick:s,children:"Cancelar"}),o.jsx("button",{className:"btn-primary",onClick:()=>{if(!r.trim())return void x("Nome Ã© obrigatÃ³rio");const e=u.split(",").map(e=>e.trim()).filter(e=>e.length>0);t(r.trim(),n.trim(),c,e),l(""),i(""),h(!1),m(""),x("")},children:"Salvar Consulta"})]})]})}):null},R=({isOpen:e,onClose:s,onLoadQuery:t,currentFilters:a})=>{const[r,l]=d.useState([]),[n,i]=d.useState(""),[c,u]=d.useState(""),[m,p]=d.useState(!1),[x,g]=d.useState("all"),[j,v]=d.useState("date");d.useEffect(()=>{y()},[]);const y=()=>{l(Q.getAllQueries())},b=h.useMemo(()=>{let e=r;switch(x){case"recent":e=Q.getRecentQueries();break;case"popular":e=Q.getPopularQueries();break;case"public":e=Q.getPublicQueries();break;default:e=r}switch(n&&(e=Q.searchQueries(n)),c&&(e=e.filter(e=>e.tags.includes(c))),j){case"name":e.sort((e,s)=>e.name.localeCompare(s.name));break;case"usage":e.sort((e,s)=>s.timesUsed-e.timesUsed);break;default:e.sort((e,s)=>new Date(s.updatedAt).getTime()-new Date(e.updatedAt).getTime())}return e},[r,n,c,x,j]),f=e=>{const s=[];return e.searchTerm&&s.push(`"${e.searchTerm}"`),e.documentTypes.length>0&&s.push(`Tipos: ${e.documentTypes.length}`),e.states.length>0&&s.push(`Estados: ${e.states.length}`),e.keywords.length>0&&s.push(`Tags: ${e.keywords.length}`),s.join(" â€¢ ")},N=Q.getAllTags(),w=Q.getStats();return e?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"saved-queries-overlay",onClick:s,children:o.jsxs("div",{className:"saved-queries-panel",onClick:e=>e.stopPropagation(),children:[o.jsxs("div",{className:"panel-header",children:[o.jsx("h2",{children:"Consultas Salvas"}),o.jsxs("div",{className:"header-actions",children:[o.jsx("button",{className:"btn-primary btn-small",onClick:()=>p(!0),disabled:!a.searchTerm&&0===a.documentTypes.length,children:"ğŸ’¾ Salvar Atual"}),o.jsx("button",{className:"panel-close",onClick:s,children:"Ã—"})]})]}),o.jsxs("div",{className:"panel-content",children:[o.jsxs("div",{className:"stats-bar",children:[o.jsxs("span",{children:[w.total," consultas"]}),o.jsx("span",{children:"â€¢"}),o.jsxs("span",{children:[w.totalUsage," usos"]}),w.mostUsed&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"â€¢"}),o.jsxs("span",{children:['Mais usada: "',w.mostUsed.name,'" (',w.mostUsed.timesUsed,"x)"]})]})]}),o.jsxs("div",{className:"search-controls",children:[o.jsx("input",{type:"text",placeholder:"Buscar consultas...",value:n,onChange:e=>i(e.target.value),className:"search-input"}),o.jsxs("select",{value:c,onChange:e=>u(e.target.value),className:"tag-filter",children:[o.jsx("option",{value:"",children:"Todas as tags"}),N.map(e=>o.jsx("option",{value:e,children:e},e))]}),o.jsxs("select",{value:j,onChange:e=>v(e.target.value),className:"sort-select",children:[o.jsx("option",{value:"date",children:"Por data"}),o.jsx("option",{value:"name",children:"Por nome"}),o.jsx("option",{value:"usage",children:"Por uso"})]})]}),o.jsxs("div",{className:"tabs",children:[o.jsxs("button",{className:"tab "+("all"===x?"active":""),onClick:()=>g("all"),children:["Todas (",w.total,")"]}),o.jsx("button",{className:"tab "+("recent"===x?"active":""),onClick:()=>g("recent"),children:"Recentes"}),o.jsx("button",{className:"tab "+("popular"===x?"active":""),onClick:()=>g("popular"),children:"Populares"}),o.jsxs("button",{className:"tab "+("public"===x?"active":""),onClick:()=>g("public"),children:["PÃºblicas (",w.public,")"]})]}),o.jsx("div",{className:"queries-list",children:0===b.length?o.jsxs("div",{className:"empty-state",children:[o.jsx("p",{children:"Nenhuma consulta encontrada."}),"all"===x&&!n&&o.jsx("button",{className:"btn-primary",onClick:()=>p(!0),disabled:!a.searchTerm&&0===a.documentTypes.length,children:"Salvar primeira consulta"})]}):b.map(e=>o.jsxs("div",{className:"query-item",children:[o.jsxs("div",{className:"query-main",children:[o.jsxs("div",{className:"query-header",children:[o.jsx("h4",{className:"query-name",children:e.name}),o.jsxs("div",{className:"query-meta",children:[e.isPublic&&o.jsx("span",{className:"public-badge",children:"PÃºblico"}),o.jsxs("span",{className:"usage-count",children:[e.timesUsed," usos"]}),o.jsx("span",{className:"query-date",children:new Date(e.updatedAt).toLocaleDateString()})]})]}),e.description&&o.jsx("p",{className:"query-description",children:e.description}),o.jsx("div",{className:"query-filters",children:f(e.filters)}),e.tags.length>0&&o.jsx("div",{className:"query-tags",children:e.tags.map(e=>o.jsx("span",{className:"tag",children:e},e))})]}),o.jsxs("div",{className:"query-actions",children:[o.jsx("button",{className:"btn-primary btn-small",onClick:()=>(e=>{Q.useQuery(e.id),t(e.filters),y()})(e),children:"Usar"}),o.jsx("button",{className:"btn-secondary btn-small",onClick:()=>(e=>{const s=`${e.name} (cÃ³pia)`;Q.duplicateQuery(e.id,s),y()})(e),children:"Duplicar"}),o.jsx("button",{className:"btn-danger btn-small",onClick:()=>{return s=e.id,void(confirm("Tem certeza que deseja excluir esta consulta?")&&(Q.deleteQuery(s),y()));var s},children:"Excluir"})]})]},e.id))})]})]})}),o.jsx(I,{isOpen:m,onClose:()=>p(!1),onSave:(e,s,t,r)=>{try{Q.saveQuery(e,a,{description:s,isPublic:t,tags:r}),y(),p(!1)}catch(l){console.error("Error saving query:",l)}},filters:a})]}):null};var Z=Object.defineProperty,U=Object.defineProperties,$=Object.getOwnPropertyDescriptors,z=Object.getOwnPropertySymbols,B=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable,J=(e,s,t)=>s in e?Z(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,Y=(e,s)=>{for(var t in s||(s={}))B.call(s,t)&&J(e,t,s[t]);if(z)for(var t of z(s))V.call(s,t)&&J(e,t,s[t]);return e},_=(e,s)=>U(e,$(s));const G=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"],W=({filters:e,onFiltersChange:s,documents:t,selectedState:a,onClearSelection:r})=>{const[l,n]=d.useState(!1),[i,c]=d.useState(-1),[h,u]=d.useState([]),[m,p]=d.useState(!1),[x,g]=d.useState(e),[j,v]=d.useState(!1),y=d.useRef(null),b=d.useRef(null),f=d.useRef(null);d.useEffect(()=>{g(e)},[e]);const N=d.useCallback(e=>{f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{console.log("ğŸ¯ Filter batch: Applying batched filter changes",{searchTerm:e.searchTerm,filtersCount:Object.keys(e).filter(s=>{const t=e[s];return Array.isArray(t)?t.length>0:!!t}).length}),s(e)},300)},[s]),w=d.useCallback(e=>{const s=Y(Y({},x),e);g(s),N(s)},[x,N]);d.useEffect(()=>{const e=localStorage.getItem("searchHistory");e&&u(JSON.parse(e))},[]),d.useEffect(()=>()=>{f.current&&clearTimeout(f.current)},[]);const C=d.useMemo(()=>{const e=new Map,s=new Map,a=new Map,r=new Map;return t.forEach(t=>{e.set(t.type,(e.get(t.type)||0)+1),t.state&&s.set(t.state,(s.get(t.state)||0)+1),t.chamber&&a.set(t.chamber,(a.get(t.chamber)||0)+1),t.keywords.forEach(e=>{r.set(e,(r.get(e)||0)+1)})}),{typeCounts:e,stateCounts:s,chamberCounts:a,keywordCounts:r}},[t]),k=d.useMemo(()=>{if(!x.searchTerm||x.searchTerm.length<2)return[];const e=x.searchTerm.toLowerCase(),s=[];return Array.from(C.keywordCounts.entries()).filter(([s])=>s.toLowerCase().includes(e)).sort((e,s)=>s[1]-e[1]).slice(0,5).forEach(([e,t])=>{s.push({text:e,type:"keyword",count:t})}),t.filter(s=>s.title.toLowerCase().includes(e)).slice(0,3).forEach(e=>{s.push({text:e.title,type:"title"})}),h.filter(s=>s.toLowerCase().includes(e)&&s!==x.searchTerm).slice(0,2).forEach(e=>{s.push({text:e,type:"recent"})}),s},[x.searchTerm,C,t,h]),S=s=>{const t=s||e.searchTerm;if(t.trim()){const e=[t,...h.filter(e=>e!==t)].slice(0,10);u(e),localStorage.setItem("searchHistory",JSON.stringify(e))}n(!1)},T=e=>{w({searchTerm:e.text}),S(e.text)},A=e=>{const s=x.documentTypes.includes(e)?x.documentTypes.filter(s=>s!==e):[...x.documentTypes,e];w({documentTypes:s})},E=e=>{const s=x.states.includes(e)?x.states.filter(s=>s!==e):[...x.states,e];w({states:s})},D=e=>{const s=x.chambers.includes(e)?x.chambers.filter(s=>s!==e):[...x.chambers,e];w({chambers:s})},M=e=>{const s=x.keywords.includes(e)?x.keywords.filter(s=>s!==e):[...x.keywords,e];w({keywords:s})},q=e.documentTypes.length>0||e.states.length>0||e.keywords.length>0||e.dateFrom||e.dateTo||e.searchTerm.trim();return d.useEffect(()=>{const e=e=>{b.current&&!b.current.contains(e.target)&&y.current&&!y.current.contains(e.target)&&n(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),o.jsxs("div",{className:"enhanced-search",children:[o.jsxs("div",{className:"search-section",children:[o.jsxs("div",{className:"search-header",children:[o.jsx("h3",{children:"Buscar Documentos"}),o.jsx("button",{className:"saved-queries-btn",onClick:()=>v(!0),"aria-label":"Consultas salvas",children:"ğŸ“š Consultas Salvas"})]}),o.jsxs("div",{className:"search-input-container",children:[o.jsx("input",{ref:y,type:"text",placeholder:"Digite palavras-chave, tÃ­tulo ou autor...",value:x.searchTerm,onChange:e=>{const s=e.target.value;w({searchTerm:s}),n(!0),c(-1)},onKeyDown:e=>{if(l&&0!==k.length)switch(e.key){case"ArrowDown":e.preventDefault(),c(e=>e<k.length-1?e+1:0);break;case"ArrowUp":e.preventDefault(),c(e=>e>0?e-1:k.length-1);break;case"Enter":e.preventDefault(),i>=0?T(k[i]):S();break;case"Escape":n(!1),c(-1)}},onFocus:()=>x.searchTerm&&n(!0),className:"search-input","aria-label":"Buscar documentos"}),o.jsx("button",{className:"search-button",onClick:()=>N(x),"aria-label":"Buscar",children:"ğŸ”"}),l&&k.length>0&&o.jsx("div",{ref:b,className:"search-suggestions",children:k.map((e,s)=>o.jsxs("div",{className:"suggestion-item "+(s===i?"selected":""),onClick:()=>T(e),children:[o.jsxs("span",{className:`suggestion-icon ${e.type}`,children:["keyword"===e.type&&"ğŸ·ï¸","title"===e.type&&"ğŸ“„","author"===e.type&&"ğŸ‘¤","recent"===e.type&&"ğŸ•"]}),o.jsx("span",{className:"suggestion-text",children:e.text}),e.count&&o.jsxs("span",{className:"suggestion-count",children:["(",e.count,")"]})]},s))})]})]}),o.jsxs("div",{className:"quick-filters",children:[o.jsx("h4",{children:"Filtros RÃ¡pidos"}),o.jsx("div",{className:"filter-chips",children:Array.from(C.keywordCounts.entries()).sort((e,s)=>s[1]-e[1]).slice(0,8).map(([s,t])=>o.jsxs("button",{className:"filter-chip "+(e.keywords.includes(s)?"selected":""),onClick:()=>M(s),children:[s," (",t,")"]},s))})]}),o.jsxs("button",{className:"advanced-toggle",onClick:()=>p(!m),"aria-expanded":m,children:[m?"â–¼":"â–¶"," Filtros AvanÃ§ados"]}),m&&o.jsxs("div",{className:"advanced-filters",children:[o.jsxs("div",{className:"filter-section",children:[o.jsx("h4",{children:"PerÃ­odo"}),o.jsxs("div",{className:"date-range",children:[o.jsx("input",{type:"date",value:e.dateFrom?e.dateFrom.toISOString().split("T")[0]:"",onChange:t=>s(_(Y({},e),{dateFrom:t.target.value?new Date(t.target.value):void 0})),"aria-label":"Data inicial"}),o.jsx("span",{children:"atÃ©"}),o.jsx("input",{type:"date",value:e.dateTo?e.dateTo.toISOString().split("T")[0]:"",onChange:t=>s(_(Y({},e),{dateTo:t.target.value?new Date(t.target.value):void 0})),"aria-label":"Data final"})]})]}),o.jsxs("div",{className:"filter-section",children:[o.jsx("h4",{children:"Tipos de Documento"}),o.jsx("div",{className:"checkbox-group",children:Array.from(C.typeCounts.entries()).sort((e,s)=>s[1]-e[1]).map(([s,t])=>o.jsxs("label",{className:"checkbox-item",children:[o.jsx("input",{type:"checkbox",checked:e.documentTypes.includes(s),onChange:()=>A(s)}),o.jsxs("span",{className:"checkbox-label",children:[s," (",t,")"]})]},s))})]}),o.jsxs("div",{className:"filter-section",children:[o.jsx("h4",{children:"Origem Legislativa"}),o.jsx("div",{className:"checkbox-group",children:Array.from(C.chamberCounts.entries()).sort((e,s)=>s[1]-e[1]).map(([s,t])=>o.jsxs("label",{className:"checkbox-item",children:[o.jsx("input",{type:"checkbox",checked:e.chambers.includes(s),onChange:()=>D(s)}),o.jsxs("span",{className:"checkbox-label",children:[s," (",t,")"]})]},s))})]}),o.jsxs("div",{className:"filter-section",children:[o.jsx("h4",{children:"Estados"}),o.jsx("div",{className:"states-grid",children:G.map(s=>{const t=C.stateCounts.get(s)||0;return 0===t?null:o.jsxs("label",{className:"state-item",children:[o.jsx("input",{type:"checkbox",checked:e.states.includes(s),onChange:()=>E(s)}),o.jsxs("span",{children:[s," (",t,")"]})]},s)})})]})]}),q&&o.jsxs("div",{className:"active-filters",children:[o.jsxs("div",{className:"active-filters-header",children:[o.jsx("span",{children:"Filtros ativos:"}),o.jsx("button",{className:"clear-all",onClick:()=>{const e={searchTerm:"",documentTypes:[],states:[],municipalities:[],chambers:[],keywords:[],dateFrom:void 0,dateTo:void 0};g(e),s(e)},children:"Limpar todos"})]}),o.jsxs("div",{className:"filter-tags",children:[e.searchTerm&&o.jsxs("span",{className:"filter-tag",children:['Busca: "',e.searchTerm,'"',o.jsx("button",{onClick:()=>s(_(Y({},e),{searchTerm:""})),children:"Ã—"})]}),e.documentTypes.map(e=>o.jsxs("span",{className:"filter-tag",children:[e,o.jsx("button",{onClick:()=>A(e),children:"Ã—"})]},e)),e.states.map(e=>o.jsxs("span",{className:"filter-tag",children:[e,o.jsx("button",{onClick:()=>E(e),children:"Ã—"})]},e)),e.chambers.map(e=>o.jsxs("span",{className:"filter-tag",children:[e,o.jsx("button",{onClick:()=>D(e),children:"Ã—"})]},e)),e.keywords.map(e=>o.jsxs("span",{className:"filter-tag",children:[e,o.jsx("button",{onClick:()=>M(e),children:"Ã—"})]},e))]})]}),a&&o.jsxs("div",{className:"selected-state",children:[o.jsxs("span",{children:["Estado selecionado: ",a]}),o.jsx("button",{onClick:r,children:"Limpar seleÃ§Ã£o"})]}),o.jsx(R,{isOpen:j,onClose:()=>v(!1),onLoadQuery:e=>{g(e),s(e),v(!1)},currentFilters:e})]})},H=({isOpen:e,onToggle:s,filters:t,onFiltersChange:a,documents:r,selectedState:l,onClearSelection:n})=>{const[i,c]=d.useState("search"),h=r.filter(e=>!(t.searchTerm&&!e.title.toLowerCase().includes(t.searchTerm.toLowerCase())&&!e.summary.toLowerCase().includes(t.searchTerm.toLowerCase())&&!e.keywords.some(e=>e.toLowerCase().includes(t.searchTerm.toLowerCase())))&&(!(t.documentTypes.length>0&&!t.documentTypes.includes(e.type))&&(!(t.chambers.length>0&&e.chamber&&!t.chambers.includes(e.chamber))&&(!(t.dateFrom&&("string"==typeof e.date?new Date(e.date):e.date)<t.dateFrom)&&(!(t.dateTo&&("string"==typeof e.date?new Date(e.date):e.date)>t.dateTo)&&(!l||e.state===l))))));return o.jsxs("aside",{className:"tabbed-sidebar "+(e?"open":"closed"),role:"complementary","aria-labelledby":"sidebar-title",children:[o.jsxs("div",{className:"sidebar-header",children:[o.jsx("h2",{id:"sidebar-title",children:"Monitor Legislativo"}),o.jsx("button",{className:"sidebar-toggle",onClick:s,"aria-label":e?"Fechar painel lateral":"Abrir painel lateral","aria-expanded":e,children:e?o.jsx(y,{size:16,weight:"bold"}):o.jsx(f,{size:16,weight:"bold"})})]}),e&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"sidebar-tabs",children:[o.jsxs("button",{className:"tab-button "+("search"===i?"active":""),onClick:()=>c("search"),"aria-selected":"search"===i,children:[o.jsx(w,{size:16,weight:"fill"})," Search & Filters"]}),o.jsxs("button",{className:"tab-button "+("analytics"===i?"active":""),onClick:()=>c("analytics"),"aria-selected":"analytics"===i,children:[o.jsx(m,{size:16,weight:"fill"})," Analytics"]}),o.jsxs("button",{className:"tab-button "+("rshiny"===i?"active":""),onClick:()=>c("rshiny"),"aria-selected":"rshiny"===i,children:[o.jsx(p,{size:16,weight:"fill"})," R Analytics"]})]}),o.jsxs("div",{className:"sidebar-content",children:["search"===i&&o.jsxs("div",{className:"search-tab",children:[o.jsx(W,{filters:t,onFiltersChange:a,documents:r,selectedState:l,onClearSelection:n}),o.jsxs("div",{className:"results-summary",children:[o.jsx("h3",{children:"Resultados"}),o.jsxs("p",{children:[h.length," documentos encontrados"]})]}),o.jsx("div",{className:"document-list",children:h.map(e=>o.jsxs("div",{className:"document-item",children:[o.jsx("h4",{children:e.title}),o.jsx("p",{className:"document-type",children:e.type}),e.chamber&&o.jsxs("p",{className:"document-chamber",children:["Origem: ",e.chamber]}),o.jsx("p",{className:"document-date",children:"string"==typeof e.date?new Date(e.date).toLocaleDateString():e.date.toLocaleDateString()}),e.state&&o.jsxs("p",{className:"document-location",children:["Estado: ",e.state]})]},e.id))})]}),"analytics"===i&&o.jsx("div",{className:"analytics-tab",children:o.jsx(C,{documents:h})}),"rshiny"===i&&o.jsx("div",{className:"rshiny-tab",children:o.jsxs("div",{className:"rshiny-info",children:[o.jsx("h3",{children:"ğŸ”¬ R Analytics Dashboard"}),o.jsx("p",{children:"Advanced statistical analysis and visualizations powered by R Shiny."}),o.jsxs("div",{className:"rshiny-stats",children:[o.jsxs("div",{className:"stat-item",children:[o.jsx("span",{className:"stat-value",children:h.length}),o.jsx("span",{className:"stat-label",children:"Documents"})]}),o.jsxs("div",{className:"stat-item",children:[o.jsx("span",{className:"stat-value",children:new Set(h.map(e=>e.state)).size}),o.jsx("span",{className:"stat-label",children:"States"})]}),o.jsxs("div",{className:"stat-item",children:[o.jsx("span",{className:"stat-value",children:new Set(h.map(e=>e.type)).size}),o.jsx("span",{className:"stat-label",children:"Types"})]})]}),o.jsxs("div",{className:"rshiny-features",children:[o.jsx("h4",{children:"Available Analyses:"}),o.jsxs("ul",{children:[o.jsx("li",{children:"ğŸ“ˆ Statistical distributions"}),o.jsx("li",{children:"ğŸ—ºï¸ Interactive geographic analysis"}),o.jsx("li",{children:"ğŸ“Š Time series analysis"}),o.jsx("li",{children:"ğŸ”— Network analysis"}),o.jsx("li",{children:"ğŸ“‹ Custom report generation"})]})]}),o.jsx("div",{className:"rshiny-note",children:o.jsxs("p",{children:[o.jsx("strong",{children:"Note:"})," The R Shiny application runs independently and provides advanced analytics capabilities beyond the standard dashboard visualizations."]})})]})})]})]})]})};var K=H;export{H as TabbedSidebar,K as default};
