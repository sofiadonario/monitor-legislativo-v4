import{j as e}from"./index-B1hR7bBa.js";import{r as a,R as r}from"./leaflet-vendor-CuwtxqHJ.js";import{G as t}from"./GlassCard-CdUHPTVl.js";import"./react-vendor-DFJYf2oa.js";var s=(e,a,r)=>new Promise((t,s)=>{var l=e=>{try{n(r.next(e))}catch(a){s(a)}},o=e=>{try{n(r.throw(e))}catch(a){s(a)}},n=e=>e.done?t(e.value):Promise.resolve(e.value).then(l,o);n((r=r.apply(e,a)).next())}),l=({onConceptSelect:l,onQueryExpansion:o,className:n="",language:i="pt",initialScheme:c="transport"})=>{var d;const[p,m]=a.useState(null),[x,h]=a.useState(null),[b,v]=a.useState(""),[u,g]=a.useState([]),[f,j]=a.useState(c),[N,y]=a.useState([]),[_,w]=a.useState(new Set),[C,T]=a.useState(!1),[S,k]=a.useState(!1),[E,q]=a.useState(null),M={transport:{scheme:"transport",total_concepts:25,max_depth:3,root_concepts:[{uri:"http://vocab.lexml.gov.br/transport/modal",label:"Modal de Transporte",children_count:4}],top_level_categories:1},concepts:{"http://vocab.lexml.gov.br/transport/modal":{uri:"http://vocab.lexml.gov.br/transport/modal",pref_label:{pt:"Modal de Transporte",en:"Transport Mode"},alt_labels:{pt:["Modalidade","Modo de Transporte"]},definition:{pt:"Categorias de modalidades de transporte"},concept_scheme:"transport",broader:[],narrower:["http://vocab.lexml.gov.br/transport/modal/rodoviario","http://vocab.lexml.gov.br/transport/modal/ferroviario","http://vocab.lexml.gov.br/transport/modal/aquaviario","http://vocab.lexml.gov.br/transport/modal/aereo"],related:[]},"http://vocab.lexml.gov.br/transport/modal/rodoviario":{uri:"http://vocab.lexml.gov.br/transport/modal/rodoviario",pref_label:{pt:"Transporte Rodoviário",en:"Road Transport"},alt_labels:{pt:["Modal Rodoviário","Transporte por Estradas"]},definition:{pt:"Transporte realizado através de rodovias e estradas"},concept_scheme:"transport",broader:["http://vocab.lexml.gov.br/transport/modal"],narrower:["http://vocab.lexml.gov.br/transport/modal/rodoviario/cargas","http://vocab.lexml.gov.br/transport/modal/rodoviario/passageiros"],related:["http://vocab.lexml.gov.br/entities/antt"]},"http://vocab.lexml.gov.br/transport/modal/ferroviario":{uri:"http://vocab.lexml.gov.br/transport/modal/ferroviario",pref_label:{pt:"Transporte Ferroviário",en:"Railway Transport"},alt_labels:{pt:["Modal Ferroviário","Transporte por Trens"]},definition:{pt:"Transporte realizado através de ferrovias"},concept_scheme:"transport",broader:["http://vocab.lexml.gov.br/transport/modal"],narrower:["http://vocab.lexml.gov.br/transport/modal/ferroviario/cargas","http://vocab.lexml.gov.br/transport/modal/ferroviario/passageiros"],related:[]},"http://vocab.lexml.gov.br/transport/modal/aquaviario":{uri:"http://vocab.lexml.gov.br/transport/modal/aquaviario",pref_label:{pt:"Transporte Aquaviário",en:"Water Transport"},alt_labels:{pt:["Modal Aquaviário","Transporte Marítimo"]},definition:{pt:"Transporte realizado através de vias aquáticas"},concept_scheme:"transport",broader:["http://vocab.lexml.gov.br/transport/modal"],narrower:["http://vocab.lexml.gov.br/transport/modal/aquaviario/maritimo","http://vocab.lexml.gov.br/transport/modal/aquaviario/fluvial"],related:["http://vocab.lexml.gov.br/entities/antaq"]},"http://vocab.lexml.gov.br/transport/modal/aereo":{uri:"http://vocab.lexml.gov.br/transport/modal/aereo",pref_label:{pt:"Transporte Aéreo",en:"Air Transport"},alt_labels:{pt:["Modal Aéreo","Aviação"]},definition:{pt:"Transporte realizado através de aeronaves"},concept_scheme:"transport",broader:["http://vocab.lexml.gov.br/transport/modal"],narrower:["http://vocab.lexml.gov.br/transport/modal/aereo/comercial","http://vocab.lexml.gov.br/transport/modal/aereo/geral"],related:["http://vocab.lexml.gov.br/entities/anac"]}}};a.useEffect(()=>{q(M[f])},[f]),a.useEffect(()=>{p&&A(p.uri)},[p]);const A=e=>s(null,null,function*(){k(!0);try{yield new Promise(e=>setTimeout(e,300));const a=M.concepts[e];if(a){const e={concept:a,path:L(a),children:a.narrower.map(e=>M.concepts[e]).filter(Boolean),parent:a.broader.length>0?M.concepts[a.broader[0]]:void 0,siblings:[],depth:R(a),is_root:0===a.broader.length,is_leaf:0===a.narrower.length};h(e),y(e.path.map(e=>M.concepts[e]).filter(Boolean))}}catch(a){console.error("Error loading concept hierarchy:",a)}finally{k(!1)}}),L=e=>{const a=[e.uri];let r=e;for(;r.broader.length>0;){const e=r.broader[0],t=M.concepts[e];if(!t)break;a.unshift(e),r=t}return a},R=e=>{let a=0,r=e;for(;r.broader.length>0;){a++;const e=r.broader[0],t=M.concepts[e];if(!t)break;r=t}return a},P=e=>{m(e),v(""),g([]),T(!1),l&&l(e)},z=e=>{const a={original:[e.pref_label[i]||e.pref_label.pt||""],narrower:[],broader:[],related:[],synonyms:e.alt_labels[i]||e.alt_labels.pt||[]};return e.narrower.forEach(e=>{const r=M.concepts[e];r&&a.narrower.push(r.pref_label[i]||r.pref_label.pt||"")}),e.broader.forEach(e=>{const r=M.concepts[e];r&&a.broader.push(r.pref_label[i]||r.pref_label.pt||"")}),e.related.forEach(e=>{const r=M.concepts[e];r&&a.related.push(r.pref_label[i]||r.pref_label.pt||"")}),o&&o(a),a},B=(a,r=0)=>{const t=a.narrower.length>0,s=_.has(a.uri),l=(null==p?void 0:p.uri)===a.uri;return e.jsxs("div",{className:"mb-1",children:[e.jsxs("div",{className:`\n            flex items-center gap-2 p-2 rounded cursor-pointer transition-colors\n            ${l?"bg-blue-100 text-blue-800":"hover:bg-gray-50"}\n          `,style:{paddingLeft:20*r+8+"px"},onClick:()=>P(a),children:[t&&e.jsx("button",{onClick:e=>{e.stopPropagation(),(e=>{const a=new Set(_);a.has(e)?a.delete(e):a.add(e),w(a)})(a.uri)},className:"p-1 hover:bg-gray-200 rounded",children:s?"🔽":"▶️"}),!t&&e.jsx("span",{className:"w-6"}),e.jsx("span",{className:"flex-1 font-medium",children:a.pref_label[i]||a.pref_label.pt}),a.narrower.length>0&&e.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:a.narrower.length})]}),t&&s&&e.jsx("div",{children:a.narrower.map(e=>{const a=M.concepts[e];return a?B(a,r+1):null})})]},a.uri)};return e.jsxs("div",{className:`vocabulary-navigator ${n}`,children:[e.jsx(t,{variant:"academic",className:"mb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Navegador de Vocabulário SKOS"}),e.jsx("p",{className:"text-gray-600",children:"Explore hierarquias de conceitos legislativos brasileiros"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>T(!C),className:"glass-button-secondary px-4 py-2 "+(C?"bg-blue-50":""),children:"🔍 Buscar"}),e.jsx("button",{onClick:()=>z(p),disabled:!p,className:"glass-button-primary px-4 py-2 disabled:opacity-50",children:"🔄 Expandir"})]})]})}),C&&e.jsxs(t,{variant:"light",className:"mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:b,onChange:e=>{var a;v(e.target.value),a=e.target.value,s(null,null,function*(){if(a.trim()){k(!0);try{yield new Promise(e=>setTimeout(e,200));const e=a.toLowerCase(),r=[];Object.values(M.concepts).forEach(a=>{const t=a.pref_label[i]||a.pref_label.pt||"",s=a.alt_labels[i]||a.alt_labels.pt||[];if(t.toLowerCase()===e)r.push({concept:a,match_type:"exact",score:1,matched_label:t});else if(t.toLowerCase().startsWith(e))r.push({concept:a,match_type:"prefix",score:.9,matched_label:t});else if(t.toLowerCase().includes(e))r.push({concept:a,match_type:"contains",score:.7,matched_label:t});else for(const l of s)if(l.toLowerCase().includes(e)){r.push({concept:a,match_type:"alternative",score:.6,matched_label:l});break}}),r.sort((e,a)=>a.score-e.score),g(r.slice(0,10))}catch(e){console.error("Error searching concepts:",e)}finally{k(!1)}}else g([])})},placeholder:"Buscar conceitos no vocabulário...",className:"glass-input pr-10"}),S&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full"})})]}),u.length>0&&e.jsxs("div",{className:"mt-4 max-h-60 overflow-y-auto",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-600 mb-2",children:["Resultados da busca (",u.length,")"]}),u.map((a,r)=>e.jsxs("div",{onClick:()=>P(a.concept),className:"flex items-center justify-between p-3 border border-gray-200 rounded mb-2 cursor-pointer hover:bg-gray-50",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.matched_label}),e.jsx("div",{className:"text-sm text-gray-600",children:a.concept.definition[i]||a.concept.definition.pt})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`\n                      px-2 py-1 rounded text-xs font-medium\n                      ${"exact"===a.match_type?"bg-green-100 text-green-700":"prefix"===a.match_type?"bg-blue-100 text-blue-700":"contains"===a.match_type?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}\n                    `,children:a.match_type}),e.jsxs("span",{className:"text-sm text-gray-500",children:[Math.round(100*a.score),"%"]})]})]},r))]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(t,{variant:"research",children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"Hierarquia de Conceitos"}),N.length>0&&e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-blue-700 mb-1",children:"Caminho:"}),e.jsx("div",{className:"flex items-center gap-2 text-sm",children:N.map((a,t)=>e.jsxs(r.Fragment,{children:[t>0&&e.jsx("span",{className:"text-gray-400",children:"→"}),e.jsx("button",{onClick:()=>P(a),className:"text-blue-600 hover:text-blue-800 hover:underline",children:a.pref_label[i]||a.pref_label.pt})]},a.uri))})]}),E&&e.jsx("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-blue-600",children:E.total_concepts}),e.jsx("div",{className:"text-gray-600",children:"Conceitos"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-green-600",children:E.max_depth}),e.jsx("div",{className:"text-gray-600",children:"Níveis"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-purple-600",children:E.top_level_categories}),e.jsx("div",{className:"text-gray-600",children:"Categorias"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-orange-600",children:f}),e.jsx("div",{className:"text-gray-600",children:"Esquema"})]})]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:null==E?void 0:E.root_concepts.map(e=>{const a=M.concepts[e.uri];return a?B(a):null})})]})}),e.jsx("div",{children:e.jsxs(t,{variant:"analysis",children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"Detalhes do Conceito"}),p?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-lg text-blue-800",children:p.pref_label[i]||p.pref_label.pt}),p.notation&&e.jsxs("div",{className:"text-sm text-gray-600",children:["Notação: ",p.notation]})]}),p.definition[i]&&e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-700 mb-1",children:"Definição:"}),e.jsx("div",{className:"text-sm text-gray-600",children:p.definition[i]||p.definition.pt})]}),(null==(d=p.alt_labels[i])?void 0:d.length)>0&&e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-700 mb-1",children:"Termos alternativos:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:p.alt_labels[i].map(a=>e.jsx("span",{className:"glass-badge text-xs",children:a},a))})]}),x&&e.jsxs("div",{className:"space-y-3",children:[x.parent&&e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-700 mb-1",children:"Conceito superior:"}),e.jsx("button",{onClick:()=>P(x.parent),className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:x.parent.pref_label[i]||x.parent.pref_label.pt})]}),x.children.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-700 mb-1",children:"Conceitos subordinados:"}),e.jsx("div",{className:"space-y-1",children:x.children.map(a=>e.jsx("button",{onClick:()=>P(a),className:"block text-sm text-blue-600 hover:text-blue-800 hover:underline",children:a.pref_label[i]||a.pref_label.pt},a.uri))})]}),p.related.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-700 mb-1",children:"Conceitos relacionados:"}),e.jsx("div",{className:"space-y-1",children:p.related.map(a=>{const r=M.concepts[a];return r?e.jsx("button",{onClick:()=>P(r),className:"block text-sm text-purple-600 hover:text-purple-800 hover:underline",children:r.pref_label[i]||r.pref_label.pt},a):null})})]}),e.jsx("div",{className:"pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold text-blue-600",children:x.depth}),e.jsx("div",{className:"text-gray-600",children:"Nível"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold text-green-600",children:x.children.length}),e.jsx("div",{className:"text-gray-600",children:"Filhos"})]})]})})]}),e.jsx("div",{className:"pt-3 border-t border-gray-200",children:e.jsx("button",{onClick:()=>z(p),className:"glass-button-primary w-full py-2 text-sm",children:"🔄 Gerar Expansão de Consulta"})})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"mb-2",children:"📚"}),e.jsx("div",{children:"Selecione um conceito para ver detalhes"})]})]})})]})]})};export{l as default};
