import{j as e}from"./index-DQmXZ-MY.js";import{r as t}from"./leaflet-vendor-CuwtxqHJ.js";import{g as a}from"./api-BEIyjD6w.js";import"./react-vendor-DFJYf2oa.js";var s=Object.defineProperty,r=(e,t,a)=>((e,t,a)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a)(e,"symbol"!=typeof t?t+"":t,a);const n=new class{constructor(){r(this,"memoryCache",new Map),r(this,"stats",{hits:0,misses:0,evictions:0,totalRequests:0}),r(this,"config",{searchResults:3e5,documentContent:18e5,suggestions:6e5,healthStatus:12e4,crossReferences:36e5,relatedDocuments:12e5,maxMemoryItems:1e3,maxItemSizeBytes:1048576,persistToLocalStorage:!0,localStoragePrefix:"lexmlCache_"}),this.loadFromLocalStorage(),setInterval(()=>this.cleanup(),6e4),"undefined"!=typeof window&&window.addEventListener("storage",this.handleStorageEvent.bind(this))}get(e){this.stats.totalRequests++;const t=this.memoryCache.get(e);return t?Date.now()>t.expiresAt?(this.memoryCache.delete(e),this.removeFromLocalStorage(e),this.stats.misses++,null):(t.accessCount++,t.lastAccessed=Date.now(),this.stats.hits++,t.data):(this.stats.misses++,this.getFromLocalStorage(e))}set(e,t,a){const s=Date.now(),r={data:t,timestamp:s,expiresAt:s+(a||this.getTTLForKey(e)),accessCount:0,lastAccessed:s};this.memoryCache.size>=this.config.maxMemoryItems&&this.evictLeastRecentlyUsed();const n=this.estimateSize(t);n>this.config.maxItemSizeBytes?console.warn(`Cache item too large (${n} bytes), skipping cache for key: ${e}`):(this.memoryCache.set(e,r),this.config.persistToLocalStorage&&this.saveToLocalStorage(e,r))}delete(e){this.memoryCache.delete(e),this.removeFromLocalStorage(e)}clear(){this.memoryCache.clear(),this.clearLocalStorage(),this.stats={hits:0,misses:0,evictions:0,totalRequests:0}}getStats(){const e=this.stats.totalRequests>0?this.stats.hits/this.stats.totalRequests*100:0,t=100-e;return{totalItems:this.memoryCache.size,memoryUsage:this.estimateMemoryUsage(),hitRate:Number(e.toFixed(2)),missRate:Number(t.toFixed(2)),evictions:this.stats.evictions}}createSearchKey(e,t,a,s){return`search:${e}:${JSON.stringify(t||{})}:${a}:${s}`}createDocumentKey(e){return`document:${e}`}createSuggestionsKey(e,t){return t?`suggestions:${t}:${e}`:`suggestions:${e}`}createCrossReferencesKey(e){return`crossref:${e}`}createRelatedDocumentsKey(e,t){return`related:${e}:${t}`}prefetchCommonQueries(){return e=this,t=function*(){["transporte","mobilidade urbana","trânsito","transporte público"].forEach(e=>{const t=this.createSearchKey(e,{},1,50);this.set(t,{prefetched:!0,query:e},this.config.searchResults)})},new Promise((a,s)=>{var r=e=>{try{o(t.next(e))}catch(a){s(a)}},n=e=>{try{o(t.throw(e))}catch(a){s(a)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(r,n);o((t=t.apply(e,null)).next())});var e,t}getTTLForKey(e){return e.startsWith("search:")?this.config.searchResults:e.startsWith("document:")?this.config.documentContent:e.startsWith("suggestions:")?this.config.suggestions:e.startsWith("health:")?this.config.healthStatus:e.startsWith("crossref:")?this.config.crossReferences:e.startsWith("related:")?this.config.relatedDocuments:this.config.searchResults}evictLeastRecentlyUsed(){let e="",t=Date.now();for(const[a,s]of this.memoryCache.entries())s.lastAccessed<t&&(t=s.lastAccessed,e=a);e&&(this.memoryCache.delete(e),this.removeFromLocalStorage(e),this.stats.evictions++)}cleanup(){const e=Date.now(),t=[];for(const[a,s]of this.memoryCache.entries())e>s.expiresAt&&t.push(a);t.forEach(e=>{this.memoryCache.delete(e),this.removeFromLocalStorage(e)})}estimateSize(e){return 2*JSON.stringify(e).length}estimateMemoryUsage(){let e=0;for(const[t,a]of this.memoryCache.entries())e+=this.estimateSize(t)+this.estimateSize(a);return e}saveToLocalStorage(e,t){if("undefined"!=typeof window)try{const a=this.config.localStoragePrefix+e;localStorage.setItem(a,JSON.stringify(t))}catch(a){console.warn("Failed to save to localStorage:",a)}}getFromLocalStorage(e){if("undefined"==typeof window)return null;try{const t=this.config.localStoragePrefix+e,a=localStorage.getItem(t);if(!a)return null;const s=JSON.parse(a);return Date.now()>s.expiresAt?(localStorage.removeItem(t),null):(this.memoryCache.set(e,s),this.stats.hits++,s.data)}catch(t){return console.warn("Failed to read from localStorage:",t),null}}removeFromLocalStorage(e){if("undefined"!=typeof window)try{const t=this.config.localStoragePrefix+e;localStorage.removeItem(t)}catch(t){console.warn("Failed to remove from localStorage:",t)}}loadFromLocalStorage(){if("undefined"!=typeof window)try{const e=this.config.localStoragePrefix;for(let t=0;t<localStorage.length;t++){const a=localStorage.key(t);if(!a||!a.startsWith(e))continue;const s=a.substring(e.length),r=localStorage.getItem(a);if(r){const e=JSON.parse(r);Date.now()<=e.expiresAt?this.memoryCache.set(s,e):localStorage.removeItem(a)}}}catch(e){console.warn("Failed to load from localStorage:",e)}}clearLocalStorage(){if("undefined"!=typeof window)try{const e=this.config.localStoragePrefix,t=[];for(let a=0;a<localStorage.length;a++){const s=localStorage.key(a);s&&s.startsWith(e)&&t.push(s)}t.forEach(e=>localStorage.removeItem(e))}catch(e){console.warn("Failed to clear localStorage:",e)}}handleStorageEvent(e){if(!e.key||!e.key.startsWith(this.config.localStoragePrefix))return;const t=e.key.substring(this.config.localStoragePrefix.length);if(null===e.newValue)this.memoryCache.delete(t);else try{const a=JSON.parse(e.newValue);Date.now()<=a.expiresAt&&this.memoryCache.set(t,a)}catch(a){console.warn("Failed to sync storage event:",a)}}};var o=Object.defineProperty,l=Object.defineProperties,i=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,m=(e,t,a)=>t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,x=(e,t)=>{for(var a in t||(t={}))d.call(t,a)&&m(e,a,t[a]);if(c)for(var a of c(t))u.call(t,a)&&m(e,a,t[a]);return e},h=(e,t)=>l(e,i(t)),g=(e,t,a)=>m(e,"symbol"!=typeof t?t+"":t,a),p=(e,t,a)=>new Promise((s,r)=>{var n=e=>{try{l(a.next(e))}catch(t){r(t)}},o=e=>{try{l(a.throw(e))}catch(t){r(t)}},l=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,o);l((a=a.apply(e,t)).next())});const b=new class{constructor(e=""){g(this,"baseURL"),g(this,"defaultTimeout",1e4),this.baseURL=e||a(),console.log(`🔧 LexMLAPIService initialized with baseURL: ${this.baseURL}`)}searchDocuments(e){return p(this,null,function*(){var t,a,s;const r=e.query||e.cql_query||"",o=e.start_record||1,l=e.max_records||50,i=((e,t,a,s)=>{const r=n.createSearchKey(e,t,a,s);return n.get(r)})(r,e.filters,o,l);if(i)return h(x({},i),{cache_hit:!0,search_time_ms:0});const c=new URLSearchParams;if(e.query&&c.append("q",e.query),e.cql_query&&c.append("cql",e.cql_query),e.filters){const t=e.filters;t.tipoDocumento.length>0&&t.tipoDocumento.forEach(e=>{c.append("tipo_documento",e)}),t.autoridade.length>0&&t.autoridade.forEach(e=>{c.append("autoridade",e)}),t.localidade.length>0&&t.localidade.forEach(e=>{c.append("localidade",e)}),t.date_from&&c.append("date_from",t.date_from),t.date_to&&c.append("date_to",t.date_to),t.subject.length>0&&t.subject.forEach(e=>{c.append("subject",e)})}e.start_record&&c.append("start_record",e.start_record.toString()),e.max_records&&c.append("max_records",e.max_records.toString()),void 0!==e.include_content&&c.append("include_content",e.include_content.toString());try{const i=new AbortController,d=setTimeout(()=>i.abort(),this.defaultTimeout),u=`${this.baseURL}/api/lexml/search?${c}`;console.log("🌐 Making API request to:",u);const m=yield fetch(u,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},signal:i.signal});if(clearTimeout(d),console.log("📡 Response received:",{status:m.status,statusText:m.statusText,ok:m.ok,headers:Object.fromEntries(m.headers.entries())}),!m.ok)throw new Error(`Search failed: ${m.status} ${m.statusText}`);const x=yield m.json();console.log("🔍 Raw API Response:",{url:`${this.baseURL}/api/lexml/search?${c}`,status:m.status,result:x,total_found:x.total_found,documents_length:null==(t=x.documents)?void 0:t.length,keys:Object.keys(x)});const h=(x.documents||[]).map(e=>{var t,a,s,r,n,o,l;return{metadata:{urn:e.urn,title:e.title,description:e.description||"",date:(null==(t=e.metadata)?void 0:t.date)||(new Date).toISOString().split("T")[0],tipoDocumento:(null==(a=e.metadata)?void 0:a.type)||"Lei",autoridade:(null==(r=null==(s=e.metadata)?void 0:s.chamber)?void 0:r.toLowerCase())||"federal",localidade:(null==(n=e.metadata)?void 0:n.state)||"BR",subject:(null==(o=e.metadata)?void 0:o.keywords)||[],identifier:e.urn,source_url:e.url},full_text:e.full_text,structure:e.structure,last_modified:(null==(l=e.metadata)?void 0:l.date)||(new Date).toISOString(),data_source:x.data_source||"csv-fallback",cache_key:e.urn}}),g={documents:h,total_found:x.total_found||(null==(a=x.documents)?void 0:a.length)||0,start_record:x.start_record||1,records_returned:h.length,next_start_record:x.next_start_record,search_time_ms:x.search_time_ms||0,data_source:x.data_source||"csv-fallback",cache_hit:x.cache_hit||!1,api_status:x.api_status||"unknown"};return console.log("🔄 Transformed Response:",{originalCount:(null==(s=x.documents)?void 0:s.length)||0,transformedCount:h.length,sampleDocument:h[0]||null}),((e,t,a,s,r)=>{const o=n.createSearchKey(e,t,a,s);n.set(o,r)})(r,e.filters,o,l,g),g}catch(d){return console.error("🚨 LexML search error details:",{error:d,message:d instanceof Error?d.message:"Unknown error",stack:d instanceof Error?d.stack:"No stack trace",name:d instanceof Error?d.name:"Unknown error type",baseURL:this.baseURL,searchParams:c.toString()}),{documents:[],total_found:0,start_record:e.start_record||1,records_returned:0,search_time_ms:0,data_source:"csv-fallback",cache_hit:!1,api_status:"error"}}})}getSuggestions(e,t=10){return p(this,null,function*(){if(e.length<2)return[];const a=(e=>{const t=n.createSuggestionsKey(e,void 0);return n.get(t)})(e);if(a)return a.slice(0,t);try{const a=yield fetch(`${this.baseURL}/api/lexml/suggest?term=${encodeURIComponent(e)}&max_suggestions=${t}`,{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`Suggestions failed: ${a.status}`);const s=(yield a.json()).suggestions||[];return((e,t)=>{const a=n.createSuggestionsKey(e,void 0);n.set(a,t)})(e,s),s}catch(s){return console.error("Suggestions error:",s),this.getLocalTaxonomySuggestions(e,t)}})}getLocalTaxonomySuggestions(e,t=10){const a=e.toLowerCase(),s={lei:{category:"Document Type",description:"Federal, state, or municipal laws"},decreto:{category:"Document Type",description:"Executive decrees and regulations"},portaria:{category:"Document Type",description:"Administrative ordinances"},"resolução":{category:"Document Type",description:"Administrative resolutions"},"medida provisória":{category:"Document Type",description:"Provisional measures (federal)"},"instrução normativa":{category:"Document Type",description:"Normative instructions"},transporte:{category:"Subject",description:"General transportation legislation"},"transporte urbano":{category:"Subject",description:"Urban transportation systems"},"mobilidade urbana":{category:"Subject",description:"Urban mobility and accessibility"},"trânsito":{category:"Subject",description:"Traffic and transit regulations"},infraestrutura:{category:"Subject",description:"Transportation infrastructure"},"logística":{category:"Subject",description:"Logistics and cargo transport"},"transporte público":{category:"Subject",description:"Public transportation systems"},"transporte coletivo":{category:"Subject",description:"Collective transportation"},"metrô":{category:"Subject",description:"Subway and metro systems"},"ônibus":{category:"Subject",description:"Bus transportation"},brt:{category:"Subject",description:"Bus Rapid Transit systems"},vlt:{category:"Subject",description:"Light Rail Transit (VLT)"},trem:{category:"Subject",description:"Train and railway transport"},aeroporto:{category:"Subject",description:"Airport infrastructure and regulation"},porto:{category:"Subject",description:"Port and maritime transport"},rodovia:{category:"Subject",description:"Highway and road infrastructure"},ciclovia:{category:"Subject",description:"Bicycle lanes and cycling infrastructure"},acessibilidade:{category:"Subject",description:"Transportation accessibility"},sustentabilidade:{category:"Subject",description:"Sustainable transportation"},federal:{category:"Authority",description:"Federal government legislation"},estadual:{category:"Authority",description:"State government legislation"},municipal:{category:"Authority",description:"Municipal government legislation"},distrital:{category:"Authority",description:"Federal District legislation"},"são paulo":{category:"Location",description:"São Paulo state or city"},"rio de janeiro":{category:"Location",description:"Rio de Janeiro state or city"},"minas gerais":{category:"Location",description:"Minas Gerais state"},"brasília":{category:"Location",description:"Federal District (Brasília)"},"paraná":{category:"Location",description:"Paraná state"},"rio grande do sul":{category:"Location",description:"Rio Grande do Sul state"},bahia:{category:"Location",description:"Bahia state"},"santa catarina":{category:"Location",description:"Santa Catarina state"},"regulamentação":{category:"Legal Concept",description:"Regulatory provisions"},licenciamento:{category:"Legal Concept",description:"Licensing and permits"},"fiscalização":{category:"Legal Concept",description:"Inspection and enforcement"},"concessão":{category:"Legal Concept",description:"Concessions and franchises"},"licitação":{category:"Legal Concept",description:"Public procurement and bidding"},tarifa:{category:"Legal Concept",description:"Tariffs and pricing"},"subsídio":{category:"Legal Concept",description:"Subsidies and financial support"}},r=[];for(const[n,o]of Object.entries(s))(n.toLowerCase().includes(a)||o.description.toLowerCase().includes(a))&&r.push({text:n,category:o.category,description:o.description,count:Math.floor(100*Math.random())+1});return r.sort((e,t)=>{const s=e.text.toLowerCase()===a,r=t.text.toLowerCase()===a,n=e.text.toLowerCase().startsWith(a),o=t.text.toLowerCase().startsWith(a);return s&&!r?-1:!s&&r?1:n&&!o?-1:!n&&o?1:t.count-e.count}),r.slice(0,t)}getFieldSuggestions(e,t,a=10){return p(this,null,function*(){const s=t.toLowerCase();switch(e){case"tipoDocumento":return[{text:"Lei",category:"Document Type",description:"Laws and statutes",count:1500},{text:"Decreto",category:"Document Type",description:"Executive decrees",count:800},{text:"Portaria",category:"Document Type",description:"Administrative ordinances",count:600},{text:"Resolução",category:"Document Type",description:"Administrative resolutions",count:400},{text:"Medida Provisória",category:"Document Type",description:"Provisional measures",count:200},{text:"Instrução Normativa",category:"Document Type",description:"Normative instructions",count:300}].filter(e=>e.text.toLowerCase().includes(s)).slice(0,a);case"autoridade":return[{text:"federal",category:"Authority",description:"Federal government",count:2e3},{text:"estadual",category:"Authority",description:"State governments",count:1500},{text:"municipal",category:"Authority",description:"Municipal governments",count:1200},{text:"distrital",category:"Authority",description:"Federal District",count:300}].filter(e=>e.text.toLowerCase().includes(s)).slice(0,a);case"localidade":return["São Paulo","Rio de Janeiro","Minas Gerais","Paraná","Rio Grande do Sul","Bahia","Santa Catarina","Distrito Federal","Goiás","Espírito Santo","Ceará","Pernambuco","Pará","Maranhão","Amazonas"].filter(e=>e.toLowerCase().includes(s)).map(e=>({text:e,category:"Location",description:`Legislation from ${e}`,count:Math.floor(500*Math.random())+50})).slice(0,a);case"subject":return["transporte","transporte urbano","mobilidade urbana","trânsito","infraestrutura","logística","transporte público","metrô","ônibus","brt","vlt","trem","aeroporto","porto","rodovia","ciclovia","acessibilidade","sustentabilidade"].filter(e=>e.toLowerCase().includes(s)).map(e=>({text:e,category:"Subject",description:`Documents about ${e}`,count:Math.floor(300*Math.random())+20})).slice(0,a);default:return this.getLocalTaxonomySuggestions(t,a)}})}getDocumentContent(e){return p(this,null,function*(){const t=(e=>{const t=n.createDocumentKey(e);return n.get(t)})(e);if(t)return h(x({},t),{cached:!0});try{const t=yield fetch(`${this.baseURL}/api/lexml/document/${encodeURIComponent(e)}`,{method:"GET",headers:{Accept:"application/json"}});if(!t.ok){if(404===t.status)return null;throw new Error(`Document retrieval failed: ${t.status}`)}const a=yield t.json();return((e,t)=>{const a=n.createDocumentKey(e);n.set(a,t)})(e,a),a}catch(a){return console.error("Document content error:",a),null}})}getHealthStatus(){return p(this,null,function*(){try{const e=yield fetch(`${this.baseURL}/api/lexml/health`,{method:"GET",headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`Health check failed: ${e.status}`);return yield e.json()}catch(e){return console.error("Health check error:",e),null}})}parseCQLQuery(e){return p(this,null,function*(){try{const t=yield fetch(`${this.baseURL}/api/lexml/cql/parse`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:`query=${encodeURIComponent(e)}`});return t.ok?{isValid:!0}:{isValid:!1,error:(yield t.json()).detail}}catch(t){return console.error("CQL parsing error:",t),{isValid:!1,error:"Network error"}}})}getCommonPatterns(){return p(this,null,function*(){try{const e=yield fetch(`${this.baseURL}/api/lexml/patterns`,{method:"GET",headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`Patterns failed: ${e.status}`);return(yield e.json()).patterns||{}}catch(e){return console.error("Patterns error:",e),{}}})}buildSimpleQuery(e,t){const a=[];if(e.trim()&&a.push(`title any "${e}" OR description any "${e}"`),t){if(t.tipoDocumento&&t.tipoDocumento.length>0){const e=t.tipoDocumento.map(e=>`tipoDocumento exact "${e}"`);a.push(`(${e.join(" OR ")})`)}if(t.autoridade&&t.autoridade.length>0){const e=t.autoridade.map(e=>`autoridade exact "${e}"`);a.push(`(${e.join(" OR ")})`)}if(t.localidade&&t.localidade.length>0){const e=t.localidade.map(e=>`localidade any "${e}"`);a.push(`(${e.join(" OR ")})`)}}return a.length>0?a.join(" AND "):"*"}searchTransportLegislation(e=""){return p(this,null,function*(){const t=e?`(title any "${e}" OR description any "${e}") AND (title any "transporte" OR description any "transporte" OR subject any "transporte")`:'title any "transporte" OR description any "transporte" OR subject any "transporte"';return this.searchDocuments({cql_query:t,start_record:1,max_records:50,include_content:!1,filters:{tipoDocumento:[],autoridade:[],localidade:[],subject:[]}})})}findCrossReferences(e){return p(this,null,function*(){const t=n.createCrossReferencesKey(e),a=n.get(t);if(a)return a;try{const a=yield fetch(`${this.baseURL}/api/lexml/document/${encodeURIComponent(e)}/references`,{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`Cross-reference discovery failed: ${a.status}`);const s=yield a.json();return n.set(t,s),s}catch(s){console.error("Cross-reference discovery error:",s);const a=yield this.extractLocalCrossReferences(e);return n.set(t,a,6e5),a}})}extractLocalCrossReferences(e){return p(this,null,function*(){const t=yield this.getDocumentContent(e);if(!t||!t.full_text)return{references:[],related_documents:[]};const a=t.full_text,s=[],r=[{regex:/Lei\s+(?:nº\s*|n\.?\s*)?(\d+(?:[.,]\d+)?)\s*,?\s*de\s+(\d{1,2})\s+de\s+(\w+)\s+de\s+(\d{4})/gi,type:"law",extract:e=>({text:e[0],description:`Lei ${e[1]} de ${e[2]} de ${e[3]} de ${e[4]}`})},{regex:/Decreto\s+(?:nº\s*|n\.?\s*)?(\d+(?:[.,]\d+)?)\s*,?\s*de\s+(\d{1,2})\s+de\s+(\w+)\s+de\s+(\d{4})/gi,type:"decree",extract:e=>({text:e[0],description:`Decreto ${e[1]} de ${e[2]} de ${e[3]} de ${e[4]}`})},{regex:/art\.?\s*(\d+(?:-[A-Z])?)/gi,type:"article",extract:e=>({text:e[0],description:`Artigo ${e[1]}`})},{regex:/§\s*(\d+)º?/gi,type:"paragraph",extract:e=>({text:e[0],description:`Parágrafo ${e[1]}`})},{regex:/inciso\s+([IVX]+)/gi,type:"paragraph",extract:e=>({text:e[0],description:`Inciso ${e[1]}`})}];for(const e of r){let t;for(;null!==(t=e.regex.exec(a));){const a=e.extract(t);s.push(x({type:e.type},a))}}return{references:s.filter((e,t,a)=>t===a.findIndex(t=>t.text===e.text)).slice(0,20),related_documents:[]}})}getRelatedDocuments(e,t=10){return p(this,null,function*(){const a=n.createRelatedDocumentsKey(e,t),s=n.get(a);if(s)return h(x({},s),{cache_hit:!0});try{const s=yield fetch(`${this.baseURL}/api/lexml/document/${encodeURIComponent(e)}/related?max_results=${t}`,{method:"GET",headers:{Accept:"application/json"}});if(!s.ok)throw new Error(`Related documents failed: ${s.status}`);const r=yield s.json();return n.set(a,r),r}catch(r){console.error("Related documents error:",r);const s=yield this.findSimilarDocumentsBySubject(e,t);return n.set(a,s,6e5),s}})}findSimilarDocumentsBySubject(e,t){return p(this,null,function*(){const a=yield this.getDocumentContent(e);if(!a||!a.metadata)return{documents:[],total_found:0,start_record:1,records_returned:0,search_time_ms:0,data_source:"csv-fallback",cache_hit:!1,api_status:"no-content"};const s=a.metadata.subject||[];if(0===s.length)return{documents:[],total_found:0,start_record:1,records_returned:0,search_time_ms:0,data_source:"csv-fallback",cache_hit:!1,api_status:"no-subjects"};const r=`(${s.slice(0,3).map(e=>`subject any "${e}"`).join(" OR ")}) AND NOT urn exact "${e}"`;return this.searchDocuments({cql_query:r,start_record:1,max_records:t,include_content:!1,filters:{tipoDocumento:[],autoridade:[],localidade:[],subject:[]}})})}};var y=Object.defineProperty,f=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable,N=(e,t,a)=>t in e?y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,w=(e,t)=>{for(var a in t||(t={}))v.call(t,a)&&N(e,a,t[a]);if(f)for(var a of f(t))j.call(t,a)&&N(e,a,t[a]);return e},S=(e,t,a)=>new Promise((s,r)=>{var n=e=>{try{l(a.next(e))}catch(t){r(t)}},o=e=>{try{l(a.throw(e))}catch(t){r(t)}},l=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,o);l((a=a.apply(e,t)).next())});const C={tipoDocumento:[],autoridade:[],localidade:[],subject:[]};var L=(e,t,a)=>new Promise((s,r)=>{var n=e=>{try{l(a.next(e))}catch(t){r(t)}},o=e=>{try{l(a.throw(e))}catch(t){r(t)}},l=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,o);l((a=a.apply(e,t)).next())}),k=({onSearch:a,onCQLSearch:s,placeholder:r="Search Brazilian legislation...",initialValue:n="",isLoading:o=!1,showAdvanced:l=!0,className:i=""})=>{const[c,d]=t.useState(n),[u,m]=t.useState([]),[x,h]=t.useState(!1),[g,p]=t.useState(!1),[y,f]=t.useState(null),v=t.useRef(null),j=t.useRef(null),N=t.useRef(null),w=()=>{const e=c.trim();e&&(g&&s?s(e):a(e),h(!1))};t.useEffect(()=>{const e=e=>{var t;!j.current||j.current.contains(e.target)||(null==(t=v.current)?void 0:t.contains(e.target))||h(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),t.useEffect(()=>()=>{N.current&&clearTimeout(N.current)},[]);const S=e=>({tipoDocumento:"bg-blue-50 text-blue-700",autoridade:"bg-purple-50 text-purple-700",localidade:"bg-green-50 text-green-700",subject:"bg-yellow-50 text-yellow-700",urn:"bg-gray-50 text-gray-700",cql:"bg-red-50 text-red-700",history:"bg-indigo-50 text-indigo-700",skos:"bg-pink-50 text-pink-700"}[e]||"bg-gray-50 text-gray-700");return e.jsxs("div",{className:`relative w-full ${i}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{ref:v,id:"lexml-search-input",name:"lexml-search",type:"text",value:c,onChange:e=>{return a=e.target.value,d(a),N.current&&clearTimeout(N.current),a.length>=2?N.current=setTimeout(()=>L(null,null,function*(){try{const e=yield b.getSuggestions(a);m(e),h(!0)}catch(e){console.error("Suggestions error:",e),m([])}}),300):(m([]),h(!1)),void(g&&a.trim()&&(t=a,L(null,null,function*(){try{const e=yield b.parseCQLQuery(t);f(e.isValid)}catch(e){f(!1)}})));var t,a},onKeyDown:e=>{var t;"Enter"===e.key?(e.preventDefault(),w()):"Escape"===e.key&&(h(!1),null==(t=v.current)||t.blur())},onFocus:()=>u.length>0&&h(!0),placeholder:g?'Enter CQL query (e.g., tipoDocumento exact "Lei")':r,className:`\n            w-full pl-10 pr-20 py-3 border rounded-lg\n            focus:ring-2 focus:ring-blue-500 focus:border-blue-500\n            ${g?"bg-red-50 border-red-200":"bg-white border-gray-300"}\n            ${g&&!1===y?"border-red-500":""}\n            ${g&&!0===y?"border-green-500":""}\n            transition-colors duration-200\n          `,disabled:o,autoComplete:"search","aria-label":g?"CQL search query":"Search Brazilian legislation"}),l&&e.jsx("button",{type:"button",onClick:()=>{p(!g),f(null),g||d("")},className:`\n              absolute inset-y-0 right-12 px-2 flex items-center\n              text-xs font-medium rounded-r-none\n              ${g?"text-red-600 bg-red-100 hover:bg-red-200":"text-gray-500 hover:text-gray-700"}\n              transition-colors duration-200\n            `,title:g?"Switch to simple search":"Switch to CQL mode",children:g?"CQL":"ABC"}),e.jsx("button",{type:"button",onClick:w,disabled:o||!c.trim(),className:"\n            absolute inset-y-0 right-0 px-4 flex items-center\n            bg-blue-600 text-white rounded-r-lg\n            hover:bg-blue-700 focus:ring-2 focus:ring-blue-500\n            disabled:bg-gray-400 disabled:cursor-not-allowed\n            transition-colors duration-200\n          ",children:o?e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"}):e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),g&&c.trim()&&null!==y&&e.jsx("div",{className:"mt-1 text-xs "+(y?"text-green-600":"text-red-600"),children:y?"✓ Valid CQL query":"✗ Invalid CQL syntax"}),x&&u.length>0&&e.jsx("div",{ref:j,className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-96 overflow-y-auto",children:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Search suggestions from LexML Brasil:"}),u.map((t,r)=>{return e.jsxs("button",{onClick:()=>(e=>{var t;e.cql_query?(d(e.cql_query),p(!0),s&&s(e.cql_query)):(d(e.text),a(e.text)),h(!1),null==(t=v.current)||t.focus()})(t),className:"\n                  w-full text-left px-3 py-2 rounded-md\n                  hover:bg-gray-50 focus:bg-gray-50\n                  flex items-center gap-3\n                  transition-colors duration-150\n                ",children:[e.jsx("span",{className:"text-lg",children:(n=t.type,{tipoDocumento:"📋",autoridade:"🏛️",localidade:"📍",subject:"🏷️",urn:"🔗",cql:"⚡",history:"🕒",skos:"📚"}[n]||"🔍")}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:t.text}),t.metadata.document_count&&e.jsxs("div",{className:"text-xs text-gray-500",children:[t.metadata.document_count.toLocaleString()," documents"]})]}),e.jsx("span",{className:`\n                  px-2 py-1 text-xs rounded-full\n                  ${S(t.type)}\n                `,children:t.type})]},r);var n})]})}),e.jsx("div",{className:"mt-2 text-xs text-gray-500",children:g?e.jsxs("span",{children:["CQL mode: Use academic queries like ",e.jsx("code",{children:'tipoDocumento exact "Lei" AND autoridade exact "federal"'})]}):e.jsx("span",{children:"Search across titles, descriptions, and subjects. Use quotes for exact phrases."})})]})};const _=[{value:"Lei",label:"Lei",description:"Federal, state, or municipal laws"},{value:"Decreto",label:"Decreto",description:"Executive decrees and regulations"},{value:"Decreto-Lei",label:"Decreto-Lei",description:"Decree-laws (historical)"},{value:"Medida Provisória",label:"Medida Provisória",description:"Provisional measures"},{value:"Portaria",label:"Portaria",description:"Administrative ordinances"},{value:"Resolução",label:"Resolução",description:"Resolutions and decisions"},{value:"Instrução Normativa",label:"Instrução Normativa",description:"Normative instructions"},{value:"Emenda Constitucional",label:"Emenda Constitucional",description:"Constitutional amendments"},{value:"Acórdão",label:"Acórdão",description:"Court decisions and rulings"},{value:"Parecer",label:"Parecer",description:"Legal opinions and reports"}],D=[{value:"federal",label:"Federal",description:"Federal government authorities"},{value:"estadual",label:"Estadual",description:"State government authorities"},{value:"municipal",label:"Municipal",description:"Municipal government authorities"},{value:"distrital",label:"Distrital",description:"Federal District authorities"}],R=[{code:"br",name:"Federal (Brasil)",description:"Federal legislation"},{code:"sao.paulo",name:"São Paulo",description:"SP state legislation"},{code:"rio.de.janeiro",name:"Rio de Janeiro",description:"RJ state legislation"},{code:"minas.gerais",name:"Minas Gerais",description:"MG state legislation"},{code:"rio.grande.sul",name:"Rio Grande do Sul",description:"RS state legislation"},{code:"parana",name:"Paraná",description:"PR state legislation"},{code:"bahia",name:"Bahia",description:"BA state legislation"},{code:"distrito.federal",name:"Distrito Federal",description:"DF legislation"},{code:"espirito.santo",name:"Espírito Santo",description:"ES state legislation"},{code:"goias",name:"Goiás",description:"GO state legislation"},{code:"santa.catarina",name:"Santa Catarina",description:"SC state legislation"},{code:"ceara",name:"Ceará",description:"CE state legislation"}],$=["transporte","transporte urbano","transporte público","transporte de carga","transporte rodoviário","transporte ferroviário","transporte aquaviário","transporte aéreo","logística","infraestrutura","mobilidade urbana","trânsito","pedágio","combustível","frete","carga","veículo"];var P=({filters:a,onFiltersChange:s,isCollapsed:r=!1,onToggleCollapse:n,className:o=""})=>{const[l,i]=t.useState(a.date_from||""),[c,d]=t.useState(a.date_to||""),u=a.tipoDocumento.length+a.autoridade.length+a.localidade.length+a.subject.length+(a.date_from?1:0)+(a.date_to?1:0);return r?e.jsx("div",{className:`bg-white border border-gray-200 rounded-lg p-4 ${o}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filters"}),u>0&&e.jsxs("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:[u," active"]})]}),e.jsx("button",{onClick:n,className:"text-sm text-blue-600 hover:text-blue-800",children:"Show filters"})]})}):e.jsxs("div",{className:`bg-white border border-gray-200 rounded-lg ${o}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg font-semibold text-gray-800",children:"Advanced Filters"}),u>0&&e.jsxs("span",{className:"bg-blue-100 text-blue-800 text-sm px-2 py-1 rounded-full",children:[u," active"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[u>0&&e.jsx("button",{onClick:()=>{i(""),d(""),s({tipoDocumento:[],autoridade:[],localidade:[],subject:[],date_from:void 0,date_to:void 0})},className:"text-sm text-red-600 hover:text-red-800",children:"Clear all"}),n&&e.jsx("button",{onClick:n,className:"text-sm text-gray-600 hover:text-gray-800",children:"Hide filters"})]})]}),e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Document Type"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:_.map(t=>e.jsxs("label",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:a.tipoDocumento.includes(t.value),onChange:e=>((e,t)=>{const r=t?[...a.tipoDocumento,e]:a.tipoDocumento.filter(t=>t!==e);s({tipoDocumento:r})})(t.value,e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-gray-700",children:t.label}),e.jsxs("span",{className:"text-gray-400 text-xs",children:["(",t.description,")"]})]},t.value))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Authority Level"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:D.map(t=>e.jsxs("label",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:a.autoridade.includes(t.value),onChange:e=>((e,t)=>{const r=t?[...a.autoridade,e]:a.autoridade.filter(t=>t!==e);s({autoridade:r})})(t.value,e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-gray-700",children:t.label}),e.jsxs("span",{className:"text-gray-400 text-xs",children:["(",t.description,")"]})]},t.value))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Geographic Scope"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 max-h-48 overflow-y-auto",children:R.map(t=>e.jsxs("label",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:a.localidade.includes(t.code),onChange:e=>((e,t)=>{const r=t?[...a.localidade,e]:a.localidade.filter(t=>t!==e);s({localidade:r})})(t.code,e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-gray-700",children:t.name}),e.jsxs("span",{className:"text-gray-400 text-xs",children:["(",t.description,")"]})]},t.code))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Date Range"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"From"}),e.jsx("input",{type:"date",value:l,onChange:e=>{return t=e.target.value,i(t),void s({date_from:t||void 0});var t},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"To"}),e.jsx("input",{type:"date",value:c,onChange:e=>{return t=e.target.value,d(t),void s({date_to:t||void 0});var t},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Transport Topics"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 max-h-32 overflow-y-auto",children:$.map(t=>e.jsxs("label",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:a.subject.includes(t),onChange:e=>((e,t)=>{const r=t?[...a.subject,e]:a.subject.filter(t=>t!==e);s({subject:r})})(t,e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-gray-700 capitalize",children:t})]},t))})]}),u>0&&e.jsxs("div",{className:"mt-6 p-3 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Active Filters:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.tipoDocumento.map(t=>e.jsxs("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:["Type: ",t]},t)),a.autoridade.map(t=>e.jsxs("span",{className:"bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded-full",children:["Authority: ",t]},t)),a.localidade.map(t=>{var a;return e.jsxs("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full",children:["Location: ",(null==(a=R.find(e=>e.code===t))?void 0:a.name)||t]},t)}),a.subject.map(t=>e.jsxs("span",{className:"bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full",children:["Topic: ",t]},t)),a.date_from&&e.jsxs("span",{className:"bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded-full",children:["From: ",a.date_from]}),a.date_to&&e.jsxs("span",{className:"bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded-full",children:["To: ",a.date_to]})]})]})]})]})};const T={"live-api":{icon:"🔴",label:"Live API",description:"Real-time data from LexML Brasil",color:"text-green-700",bgColor:"bg-green-50",borderColor:"border-green-200"},"cached-api":{icon:"🟡",label:"Cached",description:"Recent data from cache",color:"text-blue-700",bgColor:"bg-blue-50",borderColor:"border-blue-200"},"csv-fallback":{icon:"⚫",label:"Fallback",description:"Local dataset (890 documents)",color:"text-gray-700",bgColor:"bg-gray-50",borderColor:"border-gray-200"}},A={connected:{icon:"✅",text:"API Connected",color:"text-green-600"},fallback:{icon:"⚠️",text:"Using Fallback",color:"text-yellow-600"},error:{icon:"❌",text:"API Error",color:"text-red-600"}};var F=({dataSource:t,apiStatus:a,searchTime:s,resultCount:r,totalAvailable:n,className:o=""})=>{const l=T[t],i=A[a];return e.jsxs("div",{className:`flex items-center gap-4 p-3 rounded-lg border ${l.bgColor} ${l.borderColor} ${o}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",title:l.description,children:l.icon}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`text-sm font-medium ${l.color}`,children:l.label}),e.jsx("span",{className:"text-xs text-gray-500",children:l.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 rounded-md bg-white/50",children:[e.jsx("span",{className:"text-sm",children:i.icon}),e.jsx("span",{className:`text-sm font-medium ${i.color}`,children:i.text})]}),void 0!==s&&e.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 rounded-md bg-white/50",children:[e.jsx("span",{className:"text-sm",children:"⚡"}),e.jsx("span",{className:"text-sm text-gray-600",children:(c=s,c?c<1e3?`${Math.round(c)}ms`:`${(c/1e3).toFixed(1)}s`:"")})]}),void 0!==r&&e.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 rounded-md bg-white/50",children:[e.jsx("span",{className:"text-sm",children:"📄"}),e.jsx("span",{className:"text-sm text-gray-600",children:void 0===r?"":"unlimited"===n?`${r.toLocaleString()} results (unlimited database)`:n&&n>r?`${r.toLocaleString()} of ${n.toLocaleString()} results`:`${r.toLocaleString()} results`})]}),"csv-fallback"===t&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 rounded-md bg-yellow-100 border border-yellow-300",children:[e.jsx("span",{className:"text-sm",children:"ℹ️"}),e.jsx("span",{className:"text-sm text-yellow-800",children:"Limited to transport legislation dataset"})]}),"live-api"===t&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 rounded-md bg-green-100 border border-green-300",children:[e.jsx("span",{className:"text-sm",children:"🚀"}),e.jsx("span",{className:"text-sm text-green-800",children:"Complete Brazilian legal database"})]})]});var c};const M=({document:t,onClick:a})=>{return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow duration-200 cursor-pointer",onClick:()=>null==a?void 0:a(t),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${r=t.metadata.tipoDocumento,{Lei:"bg-blue-100 text-blue-800",Decreto:"bg-green-100 text-green-800",Portaria:"bg-yellow-100 text-yellow-800","Resolução":"bg-purple-100 text-purple-800","Medida Provisória":"bg-red-100 text-red-800","Instrução Normativa":"bg-indigo-100 text-indigo-800"}[r]||"bg-gray-100 text-gray-800"}`,children:t.metadata.tipoDocumento}),e.jsxs("span",{className:"flex items-center gap-1 text-xs text-gray-600",children:[(s=t.metadata.autoridade,{federal:"🇧🇷",estadual:"🏛️",municipal:"🏢",distrital:"🏛️"}[s]||"📋"),t.metadata.autoridade]}),e.jsxs("span",{className:"text-xs text-gray-500",children:["📍 ",t.metadata.localidade]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:`\n            px-2 py-1 text-xs rounded-full\n            ${"live-api"===t.data_source?"bg-green-100 text-green-700":"cached-api"===t.data_source?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}\n          `,children:"live-api"===t.data_source?"🔴 Live":"cached-api"===t.data_source?"🟡 Cached":"⚫ Fallback"})})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2 line-clamp-2",children:t.metadata.title}),t.metadata.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:t.metadata.description}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:["📅 ",(e=>{try{return new Date(e).toLocaleDateString("pt-BR",{year:"numeric",month:"long",day:"numeric"})}catch(t){return e}})(t.metadata.date)]}),e.jsxs("span",{className:"flex items-center gap-1",children:["🔗 ",t.metadata.urn.split(":").pop()||"N/A"]})]}),t.metadata.subject.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1",children:[t.metadata.subject.slice(0,5).map((t,a)=>e.jsx("span",{className:"bg-gray-100 text-gray-700 text-xs px-2 py-1 rounded-full",children:t},a)),t.metadata.subject.length>5&&e.jsxs("span",{className:"bg-gray-100 text-gray-700 text-xs px-2 py-1 rounded-full",children:["+",t.metadata.subject.length-5," more"]})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100 flex items-center justify-between",children:[e.jsxs("button",{className:"text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center gap-1",children:["📄 View Full Document",e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),t.metadata.identifier&&e.jsx("a",{href:t.metadata.identifier,target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"text-gray-600 hover:text-gray-800 text-sm flex items-center gap-1",children:"🌐 Official Source"})]})]});var s,r};var q=({documents:a,dataSource:s,apiStatus:r,searchTime:n,resultCount:o,totalAvailable:l,isLoading:i=!1,hasNextPage:c=!1,onLoadMore:d,onDocumentClick:u,className:m=""})=>{const[x,h]=t.useState("card");return i||0!==a.length?e.jsxs("div",{className:m,children:[e.jsx(F,{dataSource:s,apiStatus:r,searchTime:n,resultCount:o,totalAvailable:l,className:"mb-4"}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Search Results"}),void 0!==o&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"csv-fallback"===s?`Showing ${a.length} of ${o} results from transport legislation dataset`:"unlimited"===l?`Showing ${a.length} results from complete legal database`:`Showing ${a.length} of ${null==l?void 0:l.toLocaleString()} results`})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"View:"}),e.jsxs("div",{className:"flex rounded-lg border border-gray-300",children:[e.jsx("button",{onClick:()=>h("card"),className:"px-3 py-1 text-sm rounded-l-lg "+("card"===x?"bg-blue-500 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:"Cards"}),e.jsx("button",{onClick:()=>h("list"),className:"px-3 py-1 text-sm rounded-r-lg "+("list"===x?"bg-blue-500 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:"List"})]})]})]}),i&&0===a.length&&e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"animate-spin h-6 w-6 border-2 border-blue-500 border-t-transparent rounded-full"}),e.jsx("span",{className:"text-gray-600",children:"connected"===r?"Searching LexML Brasil database...":"Searching documents..."})]})}),e.jsx("div",{className:"card"===x?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4":"space-y-4",children:a.map((t,a)=>e.jsx(M,{document:t,onClick:u},`${t.metadata.urn}-${a}`))}),c&&d&&e.jsx("div",{className:"mt-8 text-center",children:e.jsx("button",{onClick:d,disabled:i,className:"\n              px-6 py-3 bg-blue-600 text-white rounded-lg\n              hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\n              disabled:bg-gray-400 disabled:cursor-not-allowed\n              flex items-center gap-2 mx-auto\n              transition-colors duration-200\n            ",children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),"Loading more..."]}):e.jsxs(e.Fragment,{children:["📄 Load More Results",e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})})}),"csv-fallback"===s&&a.length>0&&e.jsx("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-blue-500 text-xl",children:"🚀"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-1",children:"Want access to the complete Brazilian legal database?"}),e.jsx("p",{className:"text-sm text-blue-800 mb-3",children:"You're currently viewing results from our transport legislation dataset (890 documents). The live API provides access to millions of documents across all legal areas."}),e.jsx("button",{className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"Check API Status →"})]})]})})]}):e.jsxs("div",{className:`bg-white border border-gray-200 rounded-lg p-8 text-center ${m}`,children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No documents found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Try adjusting your search terms or filters to find relevant legislation."}),"fallback"===r&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 max-w-md mx-auto",children:e.jsx("p",{className:"text-sm text-yellow-800",children:"⚠️ Currently using fallback dataset. Try searching for transport-related terms or wait for API connectivity to restore for full database access."})})]})},E=(e,t,a)=>new Promise((s,r)=>{var n=e=>{try{l(a.next(e))}catch(t){r(t)}},o=e=>{try{l(a.throw(e))}catch(t){r(t)}},l=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,o);l((a=a.apply(e,t)).next())});const I=[{id:"abnt",name:"ABNT",format:e=>{const t=new Date(e.metadata.date);t.getFullYear();const a=t.toLocaleDateString("pt-BR");return"Lei"===e.metadata.tipoDocumento?`${e.metadata.localidade.toUpperCase()}. Lei nº [número], de ${a}. ${e.metadata.title}. Disponível em: ${e.metadata.identifier}. Acesso em: ${(new Date).toLocaleDateString("pt-BR")}.`:`${e.metadata.localidade.toUpperCase()}. ${e.metadata.tipoDocumento} [número], de ${a}. ${e.metadata.title}. Disponível em: ${e.metadata.identifier}. Acesso em: ${(new Date).toLocaleDateString("pt-BR")}.`}},{id:"apa",name:"APA",format:e=>{const t=new Date(e.metadata.date).getFullYear();return`${e.metadata.autoridade} (${t}). ${e.metadata.title}. Retrieved from ${e.metadata.identifier}`}},{id:"chicago",name:"Chicago",format:e=>{const t=new Date(e.metadata.date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return`"${e.metadata.title}," ${e.metadata.tipoDocumento}, ${t}, ${e.metadata.identifier}.`}}];var O=({document:a,onClose:s,className:r=""})=>{var n,o;const[l,i]=t.useState(null),[c,d]=t.useState(!0),[u,m]=t.useState(null),[x,h]=t.useState("abnt"),[g,p]=t.useState(!1),[y,f]=t.useState(null),[v,j]=t.useState(null),[N,w]=t.useState("content");return t.useEffect(()=>{E(null,null,function*(){d(!0),m(null);try{const e=yield b.getDocumentContent(a.metadata.urn);i(e),b.findCrossReferences(a.metadata.urn).then(e=>f(e)).catch(e=>console.warn("Cross-references failed:",e)),b.getRelatedDocuments(a.metadata.urn,10).then(e=>j(e)).catch(e=>console.warn("Related documents failed:",e))}catch(e){console.error("Error loading document content:",e),m("Failed to load document content")}finally{d(!1)}})},[a.metadata.urn]),e.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 ${r}`,children:e.jsxs("div",{className:"bg-white rounded-lg max-w-5xl w-full max-h-[95vh] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded-full border ${C=a.metadata.tipoDocumento,{Lei:"bg-blue-100 text-blue-800 border-blue-200",Decreto:"bg-green-100 text-green-800 border-green-200",Portaria:"bg-yellow-100 text-yellow-800 border-yellow-200","Resolução":"bg-purple-100 text-purple-800 border-purple-200","Medida Provisória":"bg-red-100 text-red-800 border-red-200"}[C]||"bg-gray-100 text-gray-800 border-gray-200"}`,children:a.metadata.tipoDocumento}),e.jsxs("span",{className:"text-sm text-gray-600",children:["📍 ",a.metadata.localidade," | 🏛️ ",a.metadata.autoridade]}),(S=a.metadata.identifier,["planalto.gov.br","camara.leg.br","senado.leg.br","in.gov.br","lexml.gov.br",".gov.br"].some(e=>S.includes(e))&&e.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 text-xs rounded-full border border-green-200",children:"✅ Official Government Source"}))]}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-1",children:a.metadata.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:["📅 ",(e=>{try{return new Date(e).toLocaleDateString("pt-BR",{year:"numeric",month:"long",day:"numeric"})}catch(t){return e}})(a.metadata.date)," | 🔗 ",a.metadata.urn]})]}),e.jsx("button",{onClick:s,className:"ml-4 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsx("div",{className:"border-b border-gray-200 bg-gray-50 px-6 py-2",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>w("content"),className:"px-3 py-2 text-sm font-medium rounded-lg transition-colors "+("content"===N?"bg-blue-100 text-blue-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"),children:"📄 Content"}),e.jsxs("button",{onClick:()=>w("references"),className:"px-3 py-2 text-sm font-medium rounded-lg transition-colors "+("references"===N?"bg-blue-100 text-blue-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"),children:["🔗 References ",(null==(n=null==y?void 0:y.references)?void 0:n.length)?`(${y.references.length})`:""]}),e.jsxs("button",{onClick:()=>w("related"),className:"px-3 py-2 text-sm font-medium rounded-lg transition-colors "+("related"===N?"bg-blue-100 text-blue-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"),children:["📚 Related ",(null==(o=null==v?void 0:v.documents)?void 0:o.length)?`(${v.documents.length})`:""]})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:["content"===N&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-lg "+("live-api"===a.data_source?"🔴":"cached-api"===a.data_source?"🟡":"⚫")}),e.jsxs("span",{className:"font-medium text-blue-900",children:["Data Source: ","live-api"===a.data_source?"Live LexML API":"cached-api"===a.data_source?"Cached API Data":"CSV Fallback Dataset"]})]}),e.jsx("p",{className:"text-sm text-blue-800",children:"csv-fallback"===a.data_source?"This document is from the transport legislation dataset. Full content may be limited.":"This document data is sourced from LexML Brasil, the official Brazilian legal database."})]}),a.metadata.description&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Description"}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:a.metadata.description})]}),a.metadata.subject.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Subjects & Keywords"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.metadata.subject.map((t,a)=>e.jsx("span",{className:"bg-gray-100 text-gray-800 px-3 py-1 text-sm rounded-full border border-gray-200",children:t},a))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Document Content"}),c&&e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"animate-spin h-6 w-6 border-2 border-blue-500 border-t-transparent rounded-full"}),e.jsx("span",{className:"text-gray-600",children:"Loading document content..."})]})}),u&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-red-500",children:"❌"}),e.jsx("span",{className:"text-red-800 font-medium",children:"Error Loading Content"})]}),e.jsx("p",{className:"text-red-700 mt-1",children:u})]}),l&&!c&&!u&&e.jsxs("div",{className:"space-y-4",children:[l.full_text_url?e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-green-500",children:"🌐"}),e.jsx("span",{className:"text-green-800 font-medium",children:"Full Document Available"})]}),e.jsx("p",{className:"text-green-700 mb-3",children:"The complete document text is available at the official government source."}),e.jsxs("a",{href:l.full_text_url,target:"_blank",rel:"noopener noreferrer",className:"\n                          inline-flex items-center gap-2 px-4 py-2 \n                          bg-green-600 text-white rounded-lg \n                          hover:bg-green-700 transition-colors\n                        ",children:["📄 View Full Document",e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]}):l.note?e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-yellow-500",children:"ℹ️"}),e.jsx("span",{className:"text-yellow-800 font-medium",children:"Limited Content"})]}),e.jsx("p",{className:"text-yellow-700",children:l.note})]}):e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:e.jsx("p",{className:"text-gray-600",children:"Document metadata loaded. Full text content retrieval capabilities are being enhanced. Please use the official source link below."})}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Document Metadata"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"URN:"}),e.jsx("code",{className:"block mt-1 p-2 bg-white border rounded font-mono text-xs break-all",children:a.metadata.urn})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Data Source:"}),e.jsx("span",{className:"block mt-1 text-gray-600",children:"api"===l.data_source?"Live LexML API":"Fallback Dataset"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Retrieved:"}),e.jsx("span",{className:"block mt-1 text-gray-600",children:new Date(l.retrieved_at).toLocaleString("pt-BR")})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Cached:"}),e.jsx("span",{className:"block mt-1 text-gray-600",children:l.cached?"Yes":"No"})]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Academic Citations"}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Format:"}),e.jsx("select",{value:x,onChange:e=>h(e.target.value),className:"text-sm border border-gray-300 rounded px-2 py-1",children:I.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))})]}),I.map(t=>x===t.id&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"bg-white border border-gray-300 rounded p-3",children:e.jsx("code",{className:"text-sm text-gray-800 break-words",children:t.format(a)})}),e.jsx("button",{onClick:()=>(e=>E(null,null,function*(){const t=e.format(a);try{yield navigator.clipboard.writeText(t),p(!0),setTimeout(()=>p(!1),2e3)}catch(s){console.error("Failed to copy citation:",s)}}))(t),className:"\n                          px-3 py-1 text-sm bg-blue-600 text-white rounded\n                          hover:bg-blue-700 transition-colors\n                          flex items-center gap-1\n                        ",children:"📋 Copy Citation"})]},t.id)),g&&e.jsx("div",{className:"mt-2 text-sm text-green-600",children:"✅ Citation copied to clipboard!"})]})]})]}),"references"===N&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Legal Cross-References"}),null===y?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"animate-spin h-6 w-6 border-2 border-blue-500 border-t-transparent rounded-full"}),e.jsx("span",{className:"text-gray-600",children:"Analyzing document for cross-references..."})]})}):0===y.references.length?e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6 text-center",children:[e.jsx("span",{className:"text-gray-500 text-lg",children:"📋"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"No cross-references found in this document."}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Cross-references include citations to other laws, decrees, articles, and legal provisions."})]}):e.jsx("div",{className:"space-y-4",children:["law","decree","article","paragraph"].map(t=>{const a=y.references.filter(e=>e.type===t);return 0===a.length?null:e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-3 capitalize",children:["law"===t?"⚖️ Laws":"decree"===t?"📜 Decrees":"article"===t?"📄 Articles":"📝 Paragraphs"," (",a.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:a.map((t,a)=>e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded p-3",children:[e.jsx("div",{className:"font-mono text-sm text-blue-700",children:t.text}),t.description&&e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:t.description}),t.url&&e.jsx("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline mt-1 inline-block",children:"View Document →"})]},a))})]},t)})})]}),"related"===N&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Related Documents"}),null===v?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"animate-spin h-6 w-6 border-2 border-blue-500 border-t-transparent rounded-full"}),e.jsx("span",{className:"text-gray-600",children:"Finding related documents..."})]})}):0===v.documents.length?e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6 text-center",children:[e.jsx("span",{className:"text-gray-500 text-lg",children:"📚"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"No related documents found."}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Related documents are found based on similar subjects, document types, and content."})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Found ",v.total_found," related documents (showing top ",v.documents.length,")"]}),v.documents.map((t,a)=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"px-2 py-1 text-xs rounded-full "+("Lei"===t.metadata.tipoDocumento?"bg-blue-100 text-blue-800":"Decreto"===t.metadata.tipoDocumento?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:t.metadata.tipoDocumento}),e.jsxs("span",{className:"text-xs text-gray-500",children:[t.metadata.localidade," | ",t.metadata.autoridade]})]}),e.jsx("h4",{className:"font-medium text-gray-900 mb-1 line-clamp-2",children:t.metadata.title}),t.metadata.description&&e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-2",children:t.metadata.description}),e.jsxs("div",{className:"text-xs text-gray-500",children:["📅 ",new Date(t.metadata.date).toLocaleDateString("pt-BR")]})]}),e.jsx("div",{className:"ml-4 flex flex-col gap-1",children:e.jsx("button",{onClick:()=>window.open(t.metadata.identifier,"_blank"),className:"text-xs text-blue-600 hover:text-blue-800",children:"View →"})})]}),t.metadata.subject.length>0&&e.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[t.metadata.subject.slice(0,3).map((t,a)=>e.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded",children:t},a)),t.metadata.subject.length>3&&e.jsxs("span",{className:"px-2 py-1 text-xs text-gray-500",children:["+",t.metadata.subject.length-3," more"]})]})]},a))]})]})]})]}),e.jsx("div",{className:"border-t border-gray-200 px-6 py-4 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("a",{href:a.metadata.identifier,target:"_blank",rel:"noopener noreferrer",className:"\n                  px-4 py-2 bg-blue-600 text-white rounded-lg\n                  hover:bg-blue-700 transition-colors\n                  flex items-center gap-2\n                ",children:["🌐 Official Source",e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),e.jsx("button",{className:"\n                px-4 py-2 bg-gray-100 text-gray-700 rounded-lg\n                hover:bg-gray-200 transition-colors\n                flex items-center gap-2\n              ",children:"📄 Export PDF"})]}),e.jsx("button",{onClick:s,className:"\n                px-4 py-2 bg-gray-600 text-white rounded-lg\n                hover:bg-gray-700 transition-colors\n              ",children:"Close"})]})})]})});var S,C},B=({className:a="",showDetails:s=!1})=>{const[r,o]=t.useState(null),[l,i]=t.useState(!0),[c,d]=t.useState(null),[u,m]=t.useState(!1);return t.useEffect(()=>{const e=()=>{return e=function*(){try{i(!0);const e=n.getStats();o(e),d(null)}catch(e){console.error("Failed to load cache stats:",e),d("Failed to load cache stats")}finally{i(!1)}},new Promise((t,a)=>{var s=t=>{try{n(e.next(t))}catch(s){a(s)}},r=t=>{try{n(e.throw(t))}catch(s){a(s)}},n=e=>e.done?t(e.value):Promise.resolve(e.value).then(s,r);n((e=e.apply(null,null)).next())});var e};e();const t=setInterval(e,3e4);return()=>clearInterval(t)},[]),l?e.jsxs("div",{className:`flex items-center gap-2 ${a}`,children:[e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-blue-500 border-t-transparent rounded-full"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Loading cache status..."})]}):c?e.jsxs("div",{className:`flex items-center gap-2 ${a}`,children:[e.jsx("span",{className:"text-red-500",children:"🔴"}),e.jsx("span",{className:"text-sm text-red-600",children:c})]}):r?e.jsxs("div",{className:`${a}`,children:[e.jsxs("div",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-50 px-2 py-1 rounded",onClick:()=>m(!u),children:[e.jsx("span",{children:(x=r.hitRate,x>=80?"🟢":x>=60?"🟡":"🔴")}),e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Cache: ",r.hitRate,"%"]}),s&&e.jsxs("span",{className:"text-xs text-gray-500",children:["(",r.totalItems," items, ",r.memoryUsage,"MB)"]}),s&&e.jsx("span",{className:"text-xs text-gray-400",children:u?"▼":"▶"})]}),u&&s&&e.jsxs("div",{className:"absolute z-50 mt-2 p-4 bg-white border border-gray-200 rounded-lg shadow-lg min-w-80",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Cache Performance"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Hit Rate:"}),e.jsxs("span",{className:`text-sm font-medium ${(e=>e>=80?"text-green-600":e>=60?"text-yellow-600":"text-red-600")(r.hitRate)}`,children:[r.hitRate,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Miss Rate:"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[r.missRate,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Memory Usage:"}),e.jsxs("span",{className:"text-sm text-gray-700",children:[r.memoryUsage,"MB"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Cached Items:"}),e.jsx("span",{className:"text-sm text-gray-700",children:r.totalItems})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Evictions:"}),e.jsx("span",{className:"text-sm text-gray-700",children:r.evictions})]})]}),e.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{n.clear(),m(!1)},className:"px-3 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200",children:"Clear Cache"}),e.jsx("button",{onClick:()=>n.prefetchCommonQueries(),className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200",children:"Prefetch Common"})]})})]})]}):null;var x},U=(e,t,a)=>new Promise((s,r)=>{var n=e=>{try{l(a.next(e))}catch(t){r(t)}},o=e=>{try{l(a.throw(e))}catch(t){r(t)}},l=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,o);l((a=a.apply(e,t)).next())}),z=({className:a="",defaultQuery:s="",onDocumentSelect:r})=>{const[n,o]=t.useState(!0),[l,i]=t.useState(null),{searchState:c,searchDocuments:d,searchWithCQL:u,loadMoreResults:m,clearResults:x,setFilters:h,apiHealth:g,refreshHealth:p}=function(e={}){const{debounceMs:a=500,autoSearch:s=!1,minQueryLength:r=3,defaultMaxRecords:n=50}=e,[o,l]=t.useState({query:"",results:[],isLoading:!1,resultCount:0,totalAvailable:0,searchTime:0,dataSource:"live-api",apiStatus:"connected",filters:C,currentPage:1,hasNextPage:!1}),[i,c]=t.useState(null),d=t.useRef(null),u=t.useRef(null),m=t.useCallback(e=>{l(t=>w(w({},t),e))},[]),x=t.useCallback((e,...t)=>S(null,[e,...t],function*(e,t={},a=!1){if(u.current&&u.current.abort(),e.trim()||0!==Object.keys(t).length){if(!(e.trim()&&e.trim().length<r)){m({isLoading:!0,query:e.trim()});try{const s=a?o.results.length+1:1,r={query:e.trim()||void 0,filters:w(w(w({},C),o.filters),t),start_record:s,max_records:n,include_content:!1},l=yield b.searchDocuments(r),i=a?[...o.results,...l.documents]:l.documents;m({results:i,resultCount:l.total_found||l.documents.length,totalAvailable:void 0===l.total_found?"unlimited":l.total_found,searchTime:l.search_time_ms,dataSource:l.data_source,apiStatus:"error"===l.api_status?"error":"csv-fallback"===l.data_source?"fallback":"connected",isLoading:!1,currentPage:Math.ceil(i.length/n),hasNextPage:void 0!==l.next_start_record&&null!==l.next_start_record,filters:w(w(w({},C),o.filters),t)})}catch(s){console.error("Search error:",s),m({isLoading:!1,apiStatus:"error",results:a?o.results:[],resultCount:a?o.resultCount:0})}}}else m({results:[],resultCount:0,totalAvailable:0,isLoading:!1})}),[o.results,o.filters,r,n,m]),h=t.useCallback((e,t)=>{d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{x(e,t)},a)},[x,a]),g=t.useCallback((e,t)=>S(null,null,function*(){s?h(e,t):yield x(e,t)}),[s,h,x]),p=t.useCallback(e=>S(null,null,function*(){m({isLoading:!0});try{const t={cql_query:e,start_record:1,max_records:n,include_content:!1,filters:C},a=yield b.searchDocuments(t);m({results:a.documents,resultCount:a.total_found||a.documents.length,totalAvailable:void 0===a.total_found?"unlimited":a.total_found,searchTime:a.search_time_ms,dataSource:a.data_source,apiStatus:"error"===a.api_status?"error":"csv-fallback"===a.data_source?"fallback":"connected",isLoading:!1,currentPage:1,hasNextPage:void 0!==a.next_start_record,query:`CQL: ${e}`})}catch(t){console.error("CQL search error:",t),m({isLoading:!1,apiStatus:"error"})}}),[n,m]),y=t.useCallback(()=>S(null,null,function*(){o.hasNextPage&&!o.isLoading&&(yield x(o.query,o.filters,!0))}),[o.hasNextPage,o.isLoading,o.query,o.filters,x]),f=t.useCallback(()=>{d.current&&clearTimeout(d.current),u.current&&u.current.abort(),m({query:"",results:[],resultCount:0,totalAvailable:0,searchTime:0,isLoading:!1,currentPage:1,hasNextPage:!1,filters:C})},[m]),v=t.useCallback(e=>{const t=w(w({},o.filters),e);m({filters:t}),o.query.trim()&&s&&h(o.query,t)},[o.filters,o.query,s,h,m]),j=t.useCallback(()=>S(null,null,function*(){try{const e=yield b.getHealthStatus();c(e)}catch(e){console.error("Health check error:",e),c(null)}}),[]);return t.useEffect(()=>{j();const e=setInterval(j,3e5);return()=>{clearInterval(e)}},[j]),t.useEffect(()=>()=>{d.current&&clearTimeout(d.current),u.current&&u.current.abort()},[]),{searchState:o,searchDocuments:g,searchWithCQL:p,loadMoreResults:y,clearResults:f,setFilters:v,apiHealth:i,refreshHealth:j}}({debounceMs:500,autoSearch:!1,minQueryLength:3,defaultMaxRecords:50}),y=t.useCallback(e=>U(null,null,function*(){yield d(e,c.filters)}),[d,c.filters]),f=t.useCallback(e=>U(null,null,function*(){yield u(e)}),[u]),v=t.useCallback(e=>{h(e)},[h]),j=t.useCallback(e=>{i(e),null==r||r(e)},[r]);return e.jsxs("div",{className:`max-w-7xl mx-auto p-4 space-y-6 ${a}`,children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"LexML Brasil Legal Search"}),e.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Real-time access to Brazil's complete legislative database. Search millions of laws, decrees, and legal documents with advanced academic research tools."})]}),g&&e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-lg "+(g.is_healthy?"🟢":"🔴"),children:g.is_healthy?"✅":"❌"}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["API Status: ",g.is_healthy?"Healthy":"Unavailable"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:["Response time: ",g.response_time_ms.toFixed(0),"ms | Success rate: ",g.success_rate.toFixed(1),"%"]}),e.jsx(B,{showDetails:!0})]})]})]}),e.jsx("button",{onClick:p,className:"text-sm text-blue-600 hover:text-blue-800",children:"Refresh Status"})]})}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsx(k,{onSearch:y,onCQLSearch:f,initialValue:s,isLoading:c.isLoading,showAdvanced:!0,className:"mb-6"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Quick Searches:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{label:"Transport Laws",query:'tipoDocumento exact "Lei" AND (title any "transporte" OR description any "transporte")'},{label:"Federal Decrees",query:'tipoDocumento exact "Decreto" AND autoridade exact "federal"'},{label:"Recent Legislation",query:'date >= "2020"'},{label:"São Paulo Laws",query:'localidade any "sao.paulo"'},{label:"Urban Mobility",query:'title any "mobilidade urbana" OR description any "mobilidade urbana"'}].map((t,a)=>e.jsx("button",{onClick:()=>f(t.query),className:"\n                  px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg\n                  hover:bg-gray-200 focus:ring-2 focus:ring-blue-500\n                  transition-colors duration-200\n                ",children:t.label},a))})]}),(c.query||c.results.length>0)&&e.jsx("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:c.query&&`Query: "${c.query}"`}),e.jsxs("div",{className:"flex items-center gap-4",children:[c.searchTime>0&&e.jsxs("span",{className:"text-gray-500",children:["⚡ ",c.searchTime.toFixed(0),"ms"]}),e.jsx("button",{onClick:x,className:"text-red-600 hover:text-red-800",children:"Clear"})]})]})})]}),e.jsx(P,{filters:c.filters,onFiltersChange:v,isCollapsed:n,onToggleCollapse:()=>o(!n)}),e.jsx(q,{documents:c.results,dataSource:c.dataSource,apiStatus:c.apiStatus,searchTime:c.searchTime,resultCount:c.resultCount,totalAvailable:c.totalAvailable,isLoading:c.isLoading,hasNextPage:c.hasNextPage,onLoadMore:m,onDocumentClick:j}),l&&e.jsx(O,{document:l,onClose:()=>i(null)})]})};const Q=({className:t=""})=>e.jsxs("div",{className:`min-h-screen bg-gray-50 ${t}`,children:[e.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Monitor Legislativo v4"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Real-time Legislative Search powered by LexML Brasil"})]}),e.jsxs("nav",{className:"flex items-center gap-4",children:[e.jsx("a",{href:"/",className:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"Dashboard"}),e.jsx("a",{href:"/search",className:"bg-blue-600 text-white px-3 py-2 rounded-md text-sm font-medium",children:"Search"}),e.jsx("a",{href:"/about",className:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"About"})]})]})})}),e.jsx("main",{className:"py-8",children:e.jsx(z,{onDocumentSelect:e=>{console.log("Document selected:",e)}})}),e.jsx("footer",{className:"bg-white border-t border-gray-200 mt-16",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("p",{children:"Monitor Legislativo v4 - Academic Research Platform"}),e.jsx("p",{className:"mt-1",children:"Data provided by LexML Brasil (FREE government service)"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"flex items-center gap-1",children:"🚀 Real-time API"}),e.jsx("span",{className:"flex items-center gap-1",children:"⚫ CSV Fallback"}),e.jsx("span",{className:"flex items-center gap-1",children:"🏛️ Official Sources"})]})]})})})]});var W=Q;export{Q as LexMLSearchPage,W as default};
