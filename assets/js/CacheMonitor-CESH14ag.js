import{j as e}from"./index-DshiUUTS.js";import{r as t}from"./leaflet-vendor-CuwtxqHJ.js";import{m as s,l as a}from"./Dashboard-D8dtKLwJ.js";import"./react-vendor-DFJYf2oa.js";import"./SkeletonLoader-DpXMiago.js";var r=Object.defineProperty,i=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,o=(e,t,s)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,c=(e,t)=>{for(var s in t||(t={}))n.call(t,s)&&o(e,s,t[s]);if(i)for(var s of i(t))l.call(t,s)&&o(e,s,t[s]);return e},h=(e,t,s)=>o(e,"symbol"!=typeof t?t+"":t,s),d=(e,t,s)=>new Promise((a,r)=>{var i=e=>{try{l(s.next(e))}catch(t){r(t)}},n=e=>{try{l(s.throw(e))}catch(t){r(t)}},l=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);l((s=s.apply(e,t)).next())});const u=class e{constructor(){h(this,"backgroundRefreshConfig"),h(this,"dependencies",new Map),h(this,"refreshQueue",new Set),h(this,"activeRefreshes",new Set),h(this,"refreshIntervalId"),h(this,"errorCounts",new Map),this.backgroundRefreshConfig={enabled:!0,interval:3e4,maxConcurrent:3,errorThreshold:5,retryAttempts:3},this.initializeDependencies(),this.startBackgroundRefresh()}static getInstance(){return e.instance||(e.instance=new e),e.instance}initializeDependencies(){[{key:"legislative_docs_*",dependsOn:["csv_data"],lastUpdated:Date.now(),refreshStrategy:"eager"},{key:"search_results_*",dependsOn:["legislative_docs_*"],lastUpdated:Date.now(),refreshStrategy:"lazy"},{key:"document_id_*",dependsOn:["legislative_docs_*"],lastUpdated:Date.now(),refreshStrategy:"lazy"},{key:"collection_status",dependsOn:[],lastUpdated:Date.now(),refreshStrategy:"scheduled"},{key:"latest_collection",dependsOn:["collection_status"],lastUpdated:Date.now(),refreshStrategy:"scheduled"}].forEach(e=>{this.dependencies.set(e.key,e)})}invalidateOnEvent(e,t){return d(this,null,function*(){switch(console.log(`🔄 Cache invalidation triggered by event: ${e}`),e){case"new_document":case"document_updated":yield this.invalidateDocumentCaches();break;case"collection_completed":yield this.invalidateCollectionCaches(),yield this.scheduleDocumentRefresh();break;case"search_criteria_changed":yield this.invalidateSearchCaches();break;case"manual_refresh":yield this.invalidateAllCaches(),yield this.scheduleImmediateRefresh();break;case"time_based":yield this.performTimeBasedInvalidation();break;case"error_threshold_reached":yield this.handleErrorThresholdReached(null==t?void 0:t.key)}})}invalidateDocumentCaches(){return d(this,null,function*(){const e=["legislative_docs_*","search_results_*","document_id_*"];for(const t of e)yield this.invalidateByPattern(t),yield this.scheduleRefresh(t)})}invalidateCollectionCaches(){return d(this,null,function*(){const e=["collection_status","latest_collection"];for(const t of e)yield s.delete(t),yield this.scheduleRefresh(t)})}invalidateSearchCaches(){return d(this,null,function*(){yield this.invalidateByPattern("search_results_*")})}invalidateAllCaches(){return d(this,null,function*(){yield s.clear(),this.dependencies.forEach((e,t)=>{this.scheduleRefresh(t)})})}invalidateByPattern(e){return d(this,null,function*(){console.log(`🧹 Invalidating cache pattern: ${e}`),e.includes("*")?yield s.clear():yield s.delete(e)})}scheduleRefresh(e){this.refreshQueue.add(e),console.log(`📅 Scheduled refresh for: ${e}`)}scheduleDocumentRefresh(){return d(this,null,function*(){this.scheduleRefresh("legislative_docs_*")})}scheduleImmediateRefresh(){return d(this,null,function*(){yield this.processRefreshQueue()})}performTimeBasedInvalidation(){return d(this,null,function*(){const e=Date.now();for(const[t,s]of this.dependencies.entries())e-s.lastUpdated>36e5&&(console.log(`⏰ Time-based invalidation for: ${t}`),yield this.invalidateByPattern(t),this.scheduleRefresh(t))})}startBackgroundRefresh(){this.backgroundRefreshConfig.enabled&&(this.refreshIntervalId=window.setInterval(()=>d(this,null,function*(){yield this.processRefreshQueue()}),this.backgroundRefreshConfig.interval),console.log("🔄 Background refresh service started"))}processRefreshQueue(){return d(this,null,function*(){if(this.activeRefreshes.size>=this.backgroundRefreshConfig.maxConcurrent)return void console.log("⏸️ Background refresh queue full, skipping");const e=Array.from(this.refreshQueue).slice(0,this.backgroundRefreshConfig.maxConcurrent-this.activeRefreshes.size);for(const t of e)this.refreshQueue.delete(t),this.activeRefreshes.add(t),this.performBackgroundRefresh(t).finally(()=>{this.activeRefreshes.delete(t)})})}performBackgroundRefresh(e){return d(this,null,function*(){try{switch(console.log(`🔄 Background refresh starting for: ${e}`),e){case"legislative_docs_*":yield a.forceRefreshDocuments();break;case"collection_status":yield a.fetchCollectionStatus();break;case"latest_collection":yield a.fetchLatestCollection();break;default:console.log(`No refresh handler for pattern: ${e}`)}const t=this.dependencies.get(e);t&&(t.lastUpdated=Date.now()),this.errorCounts.delete(e),console.log(`✅ Background refresh completed for: ${e}`)}catch(t){console.error(`❌ Background refresh failed for ${e}:`,t);const s=(this.errorCounts.get(e)||0)+1;this.errorCounts.set(e,s),s>=this.backgroundRefreshConfig.errorThreshold?yield this.handleErrorThresholdReached(e):s<=this.backgroundRefreshConfig.retryAttempts&&setTimeout(()=>{this.scheduleRefresh(e)},1e3*Math.pow(2,s))}})}handleErrorThresholdReached(e){return d(this,null,function*(){console.warn(`🚨 Error threshold reached for: ${e}`),e&&(this.refreshQueue.delete(e),setTimeout(()=>{this.errorCounts.delete(e),this.scheduleRefresh(e),console.log(`🔄 Recovery attempt scheduled for: ${e}`)},3e5))})}preloadCriticalData(){return d(this,null,function*(){console.log("🚀 Preloading critical cache data...");try{const e=["transporte","mobilidade","trânsito"].map(e=>d(null,null,function*(){yield a.searchDocuments(e)}));e.push(a.fetchDocuments()),e.push(a.fetchCollectionStatus()),yield Promise.allSettled(e),console.log("✅ Critical data preloading completed")}catch(e){console.error("❌ Critical data preloading failed:",e)}})}updateRefreshConfig(e){this.backgroundRefreshConfig=c(c({},this.backgroundRefreshConfig),e),e.interval&&this.refreshIntervalId&&(clearInterval(this.refreshIntervalId),this.startBackgroundRefresh())}getInvalidationStats(){return{activeRefreshes:this.activeRefreshes.size,queuedRefreshes:this.refreshQueue.size,errorCounts:Object.fromEntries(this.errorCounts),dependencies:Array.from(this.dependencies.keys()),config:this.backgroundRefreshConfig}}forceClearAll(){return d(this,null,function*(){yield this.invalidateOnEvent("manual_refresh")})}forceRefreshPattern(e){return d(this,null,function*(){yield this.invalidateByPattern(e),this.scheduleRefresh(e)})}dispose(){this.refreshIntervalId&&clearInterval(this.refreshIntervalId),this.refreshQueue.clear(),this.activeRefreshes.clear(),this.errorCounts.clear(),console.log("🧹 Cache invalidation service disposed")}};h(u,"instance");const m=u.getInstance();var g=Object.defineProperty,f=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable,y=(e,t,s)=>t in e?g(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,x=(e,t)=>{for(var s in t||(t={}))p.call(t,s)&&y(e,s,t[s]);if(f)for(var s of f(t))v.call(t,s)&&y(e,s,t[s]);return e},C=(e,t,s)=>y(e,"symbol"!=typeof t?t+"":t,s);const j=class e{constructor(){C(this,"dataPoints",[]),C(this,"config"),C(this,"samplingIntervalId"),C(this,"isCollecting",!1),this.config={dataRetentionDays:7,samplingInterval:6e4,trendAnalysisWindow:20,alertThresholds:{hitRateMin:30,responseTimeMax:1e3,errorRateMax:10,memoryUsageMax:83886080}},this.loadStoredData()}static getInstance(){return e.instance||(e.instance=new e),e.instance}startDataCollection(){this.isCollecting?console.log("Cache analytics already collecting"):(this.isCollecting=!0,console.log("🔬 Starting cache analytics data collection"),this.collectDataPoint(),this.samplingIntervalId=window.setInterval(()=>{this.collectDataPoint()},this.config.samplingInterval),setInterval(()=>{this.cleanupOldData()},36e5))}stopDataCollection(){this.isCollecting&&(this.isCollecting=!1,this.samplingIntervalId&&(clearInterval(this.samplingIntervalId),this.samplingIntervalId=void 0),console.log("⏹️ Stopped cache analytics data collection"))}collectDataPoint(){return e=this,t=function*(){try{const[e,t,a]=yield Promise.all([s.getStats(),s.getCacheSizes(),m.getInvalidationStats()]),r=Object.values(a.errorCounts).reduce((e,t)=>e+t,0),i={timestamp:Date.now(),hitRate:e.hitRate,averageResponseTime:e.averageResponseTime,cacheEfficiency:e.cacheEfficiency,totalRequests:e.totalRequests,memoryUsage:t.memory,sessionUsage:t.session,localUsage:t.local,redisUsage:t.redis,totalSize:t.memory+t.session+t.local+t.redis,activeRefreshes:a.activeRefreshes,queuedRefreshes:a.queuedRefreshes,errorCount:r};this.dataPoints.push(i),this.saveDataToStorage(),this.detectSignificantChanges(i)}catch(e){console.error("Failed to collect cache analytics data:",e)}},new Promise((s,a)=>{var r=e=>{try{n(t.next(e))}catch(s){a(s)}},i=e=>{try{n(t.throw(e))}catch(s){a(s)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(r,i);n((t=t.apply(e,null)).next())});var e,t}detectSignificantChanges(e){if(this.dataPoints.length<2)return;const t=this.dataPoints[this.dataPoints.length-2];e.hitRate<t.hitRate-20&&console.warn(`📉 Significant hit rate drop: ${t.hitRate.toFixed(1)}% → ${e.hitRate.toFixed(1)}%`),e.averageResponseTime>2*t.averageResponseTime&&console.warn(`🐌 Response time spike: ${t.averageResponseTime.toFixed(0)}ms → ${e.averageResponseTime.toFixed(0)}ms`),e.memoryUsage>this.config.alertThresholds.memoryUsageMax&&console.warn(`💾 High memory usage: ${(e.memoryUsage/1024/1024).toFixed(1)}MB`),e.errorCount>t.errorCount+5&&console.warn(`🚨 Error count spike: ${t.errorCount} → ${e.errorCount}`)}analyzePerformanceTrends(){if(this.dataPoints.length<this.config.trendAnalysisWindow)return[];const e=this.dataPoints.slice(-this.config.trendAnalysisWindow),t=Math.floor(e.length/2),s=e.slice(0,t),a=e.slice(t),r=[];return r.push(this.calculateTrend("hitRate",s,a)),r.push(this.calculateTrend("averageResponseTime",s,a,!0)),r.push(this.calculateTrend("cacheEfficiency",s,a)),r.push(this.calculateTrend("memoryUsage",s,a,!0)),r}calculateTrend(e,t,s,a=!1){const r=t.reduce((t,s)=>t+s[e],0)/t.length,i=s.reduce((t,s)=>t+s[e],0)/s.length,n=(i-r)/r*100;let l;l=Math.abs(n)<5?"stable":a?n<0?"improving":"declining":n>0?"improving":"declining";const o=(this.calculateStandardDeviation(t.map(t=>t[e]))+this.calculateStandardDeviation(s.map(t=>t[e])))/2,c=Math.max(0,100-o/Math.abs(i-r)*100);return{metric:e,trend:l,changePercentage:n,confidence:Math.min(100,c),recommendation:this.generateTrendRecommendation(e,l,n)}}calculateStandardDeviation(e){const t=e.reduce((e,t)=>e+t,0)/e.length,s=e.map(e=>Math.pow(e-t,2)),a=s.reduce((e,t)=>e+t,0)/s.length;return Math.sqrt(a)}generateTrendRecommendation(e,t,s){var a;if("stable"!==t)return(null==(a={hitRate:{declining:"Consider preloading frequently accessed data or reviewing cache invalidation strategy",improving:"Continue current caching strategy - performance is improving"},averageResponseTime:{declining:"Investigate slow cache operations, consider optimizing cache layers or compression",improving:"Response times are improving - current optimizations are working"},cacheEfficiency:{declining:"Review cache hit patterns and consider adjusting cache sizes or TTL values",improving:"Cache efficiency is improving - maintain current configuration"},memoryUsage:{declining:"Memory usage is increasing - consider reducing cache sizes or implementing more aggressive eviction",improving:"Memory usage is optimizing well"}}[e])?void 0:a[t])||void 0}assessCacheHealth(){if(0===this.dataPoints.length)return{overallScore:0,healthStatus:"critical",issues:["No analytics data available"],recommendations:["Start cache analytics data collection"],trends:[]};const e=this.dataPoints[this.dataPoints.length-1],t=this.analyzePerformanceTrends();let s=100;const a=[],r=[];e.hitRate<this.config.alertThresholds.hitRateMin&&(s-=30,a.push(`Low hit rate: ${e.hitRate.toFixed(1)}%`),r.push("Increase cache TTL or preload frequently accessed data")),e.averageResponseTime>this.config.alertThresholds.responseTimeMax&&(s-=25,a.push(`High response time: ${e.averageResponseTime.toFixed(0)}ms`),r.push("Optimize cache operations or reduce data compression")),e.memoryUsage>this.config.alertThresholds.memoryUsageMax&&(s-=20,a.push(`High memory usage: ${(e.memoryUsage/1024/1024).toFixed(1)}MB`),r.push("Reduce memory cache size or implement more aggressive eviction"));const i=e.errorCount/Math.max(1,e.totalRequests)*100;i>this.config.alertThresholds.errorRateMax&&(s-=15,a.push(`High error rate: ${i.toFixed(1)}%`),r.push("Investigate cache operation failures and improve error handling"));const n=t.filter(e=>"declining"===e.trend&&e.confidence>70);let l;return n.length>0&&(s-=10*n.length,a.push(`${n.length} declining performance trend(s)`),r.push("Review declining metrics and implement optimizations")),s=Math.max(0,s),l=s>=90?"excellent":s>=75?"good":s>=60?"fair":s>=40?"poor":"critical",{overallScore:s,healthStatus:l,issues:a,recommendations:r,trends:t}}getHistoricalData(e){const t=Date.now();let s;switch(e){case"hour":s=t-36e5;break;case"day":s=t-864e5;break;case"week":s=t-6048e5;break;default:return this.dataPoints}return this.dataPoints.filter(e=>e.timestamp>=s)}getPerformanceSummary(e){const t=this.getHistoricalData(e);if(0===t.length)return null;const s=t[t.length-1],a=t[0];return{current:{hitRate:s.hitRate,responseTime:s.averageResponseTime,efficiency:s.cacheEfficiency,memoryUsage:s.memoryUsage},averages:{hitRate:t.reduce((e,t)=>e+t.hitRate,0)/t.length,responseTime:t.reduce((e,t)=>e+t.averageResponseTime,0)/t.length,efficiency:t.reduce((e,t)=>e+t.cacheEfficiency,0)/t.length,memoryUsage:t.reduce((e,t)=>e+t.memoryUsage,0)/t.length},changes:e&&t.length>1?{hitRate:s.hitRate-a.hitRate,responseTime:s.averageResponseTime-a.averageResponseTime,efficiency:s.cacheEfficiency-a.cacheEfficiency,memoryUsage:s.memoryUsage-a.memoryUsage}:void 0,dataPoints:t.length,timeRange:e||"all"}}cleanupOldData(){const e=Date.now()-24*this.config.dataRetentionDays*60*60*1e3,t=this.dataPoints.length;this.dataPoints=this.dataPoints.filter(t=>t.timestamp>=e),this.dataPoints.length!==t&&(console.log(`🧹 Cleaned up ${t-this.dataPoints.length} old analytics data points`),this.saveDataToStorage())}loadStoredData(){try{const e=localStorage.getItem("cache_analytics_data");e&&(this.dataPoints=JSON.parse(e),console.log(`📊 Loaded ${this.dataPoints.length} analytics data points from storage`))}catch(e){console.warn("Failed to load stored analytics data:",e),this.dataPoints=[]}}saveDataToStorage(){try{localStorage.setItem("cache_analytics_data",JSON.stringify(this.dataPoints))}catch(e){console.warn("Failed to save analytics data to storage:",e)}}exportData(e="json"){return"csv"===e?[Object.keys(this.dataPoints[0]||{}).join(","),...this.dataPoints.map(e=>Object.values(e).map(e=>"string"==typeof e?`"${e}"`:e).join(","))].join("\n"):JSON.stringify(this.dataPoints,null,2)}clearAnalyticsData(){this.dataPoints=[],localStorage.removeItem("cache_analytics_data"),console.log("🗑️ Cleared all analytics data")}getConfig(){return x({},this.config)}updateConfig(e){this.config=x(x({},this.config),e),e.samplingInterval&&this.isCollecting&&(this.stopDataCollection(),this.startDataCollection())}dispose(){this.stopDataCollection(),this.saveDataToStorage(),console.log("🧹 Cache analytics service disposed")}};C(j,"instance");const b=j.getInstance();var R=Object.defineProperty,S=Object.defineProperties,k=Object.getOwnPropertyDescriptors,w=Object.getOwnPropertySymbols,N=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable,T=(e,t,s)=>t in e?R(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,D=(e,t,s)=>new Promise((a,r)=>{var i=e=>{try{l(s.next(e))}catch(t){r(t)}},n=e=>{try{l(s.throw(e))}catch(t){r(t)}},l=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);l((s=s.apply(e,t)).next())}),I=({className:r="",showDetailedView:i=!1})=>{const{cacheStatus:n,isLoading:l,error:o,clearCache:c,preloadCache:h,forceRefresh:d,refreshStatus:u,getCacheHealthColor:g,getCacheHealthText:f,getHitRateColor:p,getResponseTimeColor:v}=function(){const[e,r]=t.useState(null),[i,n]=t.useState(!0),[l,o]=t.useState(null),c=t.useCallback(e=>{if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB"][t]},[]),h=t.useCallback(()=>D(null,null,function*(){try{n(!0),o(null);const[a,i,l,h,d]=yield Promise.all([s.getStats(),s.getCacheSizes(),m.getInvalidationStats(),b.assessCacheHealth(),b.getPerformanceSummary("day")]),u=i.memory+i.session+i.local+i.redis,g=(e=((e,t)=>{for(var s in t||(t={}))N.call(t,s)&&T(e,s,t[s]);if(w)for(var s of w(t))P.call(t,s)&&T(e,s,t[s]);return e})({},i),t={totalSize:u,formatted:{memory:c(i.memory),session:c(i.session),local:c(i.local),redis:c(i.redis),total:c(u)}},S(e,k(t))),f="excellent"===h.healthStatus||"good"===h.healthStatus;r({metrics:a,sizes:g,invalidation:l,health:h,performance:d,isHealthy:f,lastUpdated:Date.now()})}catch(a){console.error("Failed to fetch cache status:",a),o(a instanceof Error?a.message:"Unknown error")}finally{n(!1)}var e,t}),[c]),d=t.useCallback(e=>D(null,null,function*(){try{yield a.invalidateCache(e),yield m.invalidateOnEvent("manual_refresh"),yield h(),console.log(`Cache cleared: ${e||"all"}`)}catch(t){console.error("Failed to clear cache:",t),o(t instanceof Error?t.message:"Failed to clear cache")}}),[h]),u=t.useCallback(()=>D(null,null,function*(){try{yield m.preloadCriticalData(),yield h(),console.log("Cache preloading completed")}catch(e){console.error("Failed to preload cache:",e),o(e instanceof Error?e.message:"Failed to preload cache")}}),[h]),g=t.useCallback(e=>D(null,null,function*(){try{e?yield m.forceRefreshPattern(e):yield m.forceClearAll(),yield h(),console.log(`Force refresh completed: ${e||"all"}`)}catch(t){console.error("Failed to force refresh:",t),o(t instanceof Error?t.message:"Failed to force refresh")}}),[h]);t.useEffect(()=>{b.startDataCollection(),h();const e=setInterval(h,3e4);return()=>{clearInterval(e)}},[h]);const f=t.useCallback(e=>e?"#4caf50":"#f44336",[]),p=t.useCallback(e=>e?"Healthy":"Needs Attention",[]),v=t.useCallback(e=>e>=70?"#4caf50":e>=50?"#ff9800":"#f44336",[]),y=t.useCallback(e=>e<=200?"#4caf50":e<=500?"#ff9800":"#f44336",[]),x=t.useCallback(e=>b.getHistoricalData(e),[]),C=t.useCallback((e="json")=>b.exportData(e),[]),j=t.useCallback(()=>{b.clearAnalyticsData()},[]),R=t.useCallback(()=>b.getConfig(),[]),I=t.useCallback(e=>{b.updateConfig(e)},[]);return{cacheStatus:e,isLoading:i,error:l,clearCache:d,preloadCache:u,forceRefresh:g,refreshStatus:h,getHistoricalData:x,exportAnalytics:C,clearAnalytics:j,getAnalyticsConfig:R,updateAnalyticsConfig:I,getCacheHealthColor:f,getCacheHealthText:p,getHitRateColor:v,getResponseTimeColor:y,formatBytes:c}}(),[y,x]=t.useState(i),[C,j]=t.useState(null),R=(e,...t)=>{return s=function*(){j(e);try{switch(e){case"clear-all":yield c("all");break;case"clear-documents":yield c("documents");break;case"clear-search":yield c("search");break;case"clear-collections":yield c("collections");break;case"preload":yield h();break;case"force-refresh":yield d();break;case"refresh-status":yield u()}}finally{j(null)}},new Promise((e,t)=>{var a=e=>{try{i(s.next(e))}catch(a){t(a)}},r=e=>{try{i(s.throw(e))}catch(a){t(a)}},i=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,r);i((s=s.apply(null,null)).next())});var s};if(l)return e.jsxs("div",{className:`cache-monitor loading ${r}`,children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("span",{children:"Loading cache status..."})]});if(o)return e.jsxs("div",{className:`cache-monitor error ${r}`,children:[e.jsx("div",{className:"error-icon",children:"⚠️"}),e.jsxs("div",{className:"error-message",children:[e.jsx("h4",{children:"Cache Monitor Error"}),e.jsx("p",{children:o}),e.jsx("button",{onClick:()=>u(),className:"retry-button",children:"Retry"})]})]});if(!n)return e.jsxs("div",{className:`cache-monitor no-data ${r}`,children:[e.jsx("div",{className:"no-data-icon",children:"📊"}),e.jsx("span",{children:"No cache data available"})]});const{metrics:I,sizes:_,invalidation:O,isHealthy:M,lastUpdated:E}=n;return e.jsxs("div",{className:`cache-monitor ${M?"healthy":"unhealthy"} ${r}`,children:[e.jsxs("div",{className:"cache-monitor-header",children:[e.jsxs("div",{className:"status-indicator",children:[e.jsx("div",{className:"status-dot",style:{backgroundColor:g(M)}}),e.jsxs("h3",{children:["Cache Status: ",f(M)]})]}),e.jsxs("div",{className:"header-actions",children:[e.jsx("button",{onClick:()=>x(!y),className:"expand-button","aria-label":y?"Collapse":"Expand",children:y?"▼":"▶"}),e.jsx("button",{onClick:()=>R("refresh-status"),className:"refresh-button",disabled:"refresh-status"===C,children:"🔄"})]})]}),e.jsxs("div",{className:"cache-metrics-summary",children:[e.jsxs("div",{className:"metric",children:[e.jsx("span",{className:"metric-label",children:"Hit Rate"}),e.jsxs("span",{className:"metric-value",style:{color:p(I.hitRate)},children:[I.hitRate.toFixed(1),"%"]})]}),e.jsxs("div",{className:"metric",children:[e.jsx("span",{className:"metric-label",children:"Avg Response"}),e.jsxs("span",{className:"metric-value",style:{color:v(I.averageResponseTime)},children:[I.averageResponseTime.toFixed(0),"ms"]})]}),e.jsxs("div",{className:"metric",children:[e.jsx("span",{className:"metric-label",children:"Total Size"}),e.jsx("span",{className:"metric-value",children:_.formatted.total})]}),e.jsxs("div",{className:"metric",children:[e.jsx("span",{className:"metric-label",children:"Efficiency"}),e.jsxs("span",{className:"metric-value",children:[I.cacheEfficiency.toFixed(1),"%"]})]})]}),y&&e.jsxs("div",{className:"cache-monitor-details",children:[e.jsxs("div",{className:"metrics-section",children:[e.jsx("h4",{children:"Performance Metrics"}),e.jsxs("div",{className:"metrics-grid",children:[e.jsxs("div",{className:"metric-item",children:[e.jsx("span",{children:"Total Requests"}),e.jsx("span",{children:I.totalRequests.toLocaleString()})]}),e.jsxs("div",{className:"metric-item",children:[e.jsx("span",{children:"Memory Hits"}),e.jsx("span",{children:I.memoryHits.toLocaleString()})]}),e.jsxs("div",{className:"metric-item",children:[e.jsx("span",{children:"Session Hits"}),e.jsx("span",{children:I.sessionStorageHits.toLocaleString()})]}),e.jsxs("div",{className:"metric-item",children:[e.jsx("span",{children:"Local Storage Hits"}),e.jsx("span",{children:I.localStorageHits.toLocaleString()})]}),e.jsxs("div",{className:"metric-item",children:[e.jsx("span",{children:"Redis Hits"}),e.jsx("span",{children:I.redisHits.toLocaleString()})]})]})]}),e.jsxs("div",{className:"storage-section",children:[e.jsx("h4",{children:"Storage Usage"}),e.jsxs("div",{className:"storage-breakdown",children:[e.jsxs("div",{className:"storage-item",children:[e.jsx("span",{children:"Memory Cache"}),e.jsx("div",{className:"storage-bar",children:e.jsx("div",{className:"storage-fill memory",style:{width:_.memory/_.totalSize*100+"%"}})}),e.jsx("span",{children:_.formatted.memory})]}),e.jsxs("div",{className:"storage-item",children:[e.jsx("span",{children:"Session Storage"}),e.jsx("div",{className:"storage-bar",children:e.jsx("div",{className:"storage-fill session",style:{width:_.session/_.totalSize*100+"%"}})}),e.jsx("span",{children:_.formatted.session})]}),e.jsxs("div",{className:"storage-item",children:[e.jsx("span",{children:"Local Storage"}),e.jsx("div",{className:"storage-bar",children:e.jsx("div",{className:"storage-fill local",style:{width:_.local/_.totalSize*100+"%"}})}),e.jsx("span",{children:_.formatted.local})]}),e.jsxs("div",{className:"storage-item",children:[e.jsx("span",{children:"Redis Cache"}),e.jsx("div",{className:"storage-bar",children:e.jsx("div",{className:"storage-fill redis",style:{width:_.redis/_.totalSize*100+"%"}})}),e.jsx("span",{children:_.formatted.redis})]})]})]}),e.jsxs("div",{className:"operations-section",children:[e.jsx("h4",{children:"Background Operations"}),e.jsxs("div",{className:"operations-info",children:[e.jsxs("div",{className:"operation-stat",children:[e.jsx("span",{children:"Active Refreshes"}),e.jsx("span",{className:O.activeRefreshes>5?"warning":"",children:O.activeRefreshes})]}),e.jsxs("div",{className:"operation-stat",children:[e.jsx("span",{children:"Queued Refreshes"}),e.jsx("span",{children:O.queuedRefreshes})]}),e.jsxs("div",{className:"operation-stat",children:[e.jsx("span",{children:"Dependencies"}),e.jsx("span",{children:O.dependencies.length})]})]}),Object.keys(O.errorCounts).length>0&&e.jsxs("div",{className:"error-counts",children:[e.jsx("h5",{children:"Error Counts"}),Object.entries(O.errorCounts).map(([t,s])=>e.jsxs("div",{className:"error-item",children:[e.jsx("span",{children:t}),e.jsx("span",{className:"error-count",children:s})]},t))]})]}),e.jsxs("div",{className:"actions-section",children:[e.jsx("h4",{children:"Cache Management"}),e.jsxs("div",{className:"action-buttons",children:[e.jsxs("button",{onClick:()=>R("preload"),disabled:"preload"===C,className:"action-button preload",children:["preload"===C?"⏳":"🚀"," Preload Cache"]}),e.jsxs("button",{onClick:()=>R("force-refresh"),disabled:"force-refresh"===C,className:"action-button refresh",children:["force-refresh"===C?"⏳":"🔄"," Force Refresh"]}),e.jsxs("button",{onClick:()=>R("clear-documents"),disabled:"clear-documents"===C,className:"action-button clear",children:["clear-documents"===C?"⏳":"📄"," Clear Documents"]}),e.jsxs("button",{onClick:()=>R("clear-search"),disabled:"clear-search"===C,className:"action-button clear",children:["clear-search"===C?"⏳":"🔍"," Clear Search"]}),e.jsxs("button",{onClick:()=>R("clear-all"),disabled:"clear-all"===C,className:"action-button clear-all",children:["clear-all"===C?"⏳":"🗑️"," Clear All"]})]})]}),e.jsxs("div",{className:"timestamp",children:["Last updated: ",new Date(E).toLocaleTimeString()]})]})]})};export{I as default};
